{"schemaVersion":1,"gitHash":"560c6bd59b23eb8953ede8cc4f1670bfb20e932c","writtenAt":"2026-02-20T21:39:53.735Z","data":{"vulnerabilities":[{"hash":"745746533001b8922a4e2735871bc91b","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4271,"col":21},"end":{"line":4271,"col":107},"lines":"console.log('[PLANNER] Looking up Azure user by email:', azureUser.displayName, email)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4271):\n\n```typescript\nconsole.log('[PLANNER] Looking up Azure user by email:', azureUser.displayName, email)\n```\n"},{"hash":"8c220df1d2c8af0136ca92e57c9d4d72","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4438,"col":27},"end":{"line":4438,"col":110},"lines":"console.log('[PLANNER] Using person role:', userRole?.name, 'for user:', user.name)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4438):\n\n```typescript\nconsole.log('[PLANNER] Using person role:', userRole?.name, 'for user:', user.name)\n```\n"},{"hash":"81ed5175e8bc76c4b0cc6bea08b8d386","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/scripts/migrate-settings-to-tenant.ts","start":{"line":75,"col":5},"end":{"line":75,"col":66},"lines":"console.log(`  companyEmail: ${updatedTenant?.companyEmail}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/scripts/migrate-settings-to-tenant.ts` (line 75):\n\n```typescript\nconsole.log(`  companyEmail: ${updatedTenant?.companyEmail}`)\n```\n"},{"hash":"78c5386958c73ab45b851be242de1aaf","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":833,"col":11},"end":{"line":833,"col":90},"lines":"console.log('[RECEIPT_UPLOAD] Starting receipt upload for expense:', expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 833):\n\n```typescript\nconsole.log('[RECEIPT_UPLOAD] Starting receipt upload for expense:', expenseId)\n```\n"},{"hash":"9cf78e99280728660849b24996252ef4","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":11475,"col":15},"end":{"line":11475,"col":115},"lines":"console.log(`[SUPPORT] Sent closure email to ${requester.email} for ticket #${ticket.ticketNumber}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 11475):\n\n```typescript\nconsole.log(`[SUPPORT] Sent closure email to ${requester.email} for ticket #${ticket.ticketNumber}`)\n```\n"},{"hash":"7052796ae1e419617001ee4faf245175","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":455,"col":7},"end":{"line":455,"col":127},"lines":"console.log(\"[EXPENSE UPDATE] Success - ID:\", updatedExpense.id, \"projectResourceId:\", updatedExpense.projectResourceId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 455):\n\n```typescript\nconsole.log(\"[EXPENSE UPDATE] Success - ID:\", updatedExpense.id, \"projectResourceId:\", updatedExpense.projectResourceId)\n```\n"},{"hash":"69974571ef6d9c055bcaa5b75daf9d29","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":174,"col":9},"end":{"line":174,"col":79},"lines":"console.log(`[EXPENSE-REMINDERS] Sent reminder to ${recipient.email}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/services/expense-reminder-scheduler.ts` (line 174):\n\n```typescript\nconsole.log(`[EXPENSE-REMINDERS] Sent reminder to ${recipient.email}`)\n```\n"},{"hash":"bb276b994b1702fa010d015c7e78612a","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4324,"col":23},"end":{"line":4324,"col":110},"lines":"console.log('[PLANNER] Created named resource and assigned:', newUser.id, newUser.name)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4324):\n\n```typescript\nconsole.log('[PLANNER] Created named resource and assigned:', newUser.id, newUser.name)\n```\n"},{"hash":"466acbda92851a940ff52fdf7e00d791","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4421,"col":25},"end":{"line":4421,"col":125},"lines":"console.log('[PLANNER] Found matching user via Azure mapping:', user?.name, 'roleId:', user?.roleId)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4421):\n\n```typescript\nconsole.log('[PLANNER] Found matching user via Azure mapping:', user?.name, 'roleId:', user?.roleId)\n```\n"},{"hash":"f3a689206cc8a075436787f0cb999e9c","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":751,"col":7},"end":{"line":751,"col":77},"lines":"console.log('[ATTACHMENT_ENDPOINT] Expense ID:', req.params.expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 751):\n\n```typescript\nconsole.log('[ATTACHMENT_ENDPOINT] Expense ID:', req.params.expenseId)\n```\n"},{"hash":"4395259bdc71518a71b3ca54dde1f528","ruleIds":["EMAIL","USERNAME"],"message":"Email and Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/storage.ts","start":{"line":2427,"col":7},"end":{"line":2438,"col":9},"lines":"console.log(\"[DIAGNOSTIC] User lookup for error message:\", {\n  personId,\n  personIdLength: personId?.length,\n  found: !!user,\n  name: user?.name,\n  email: user?.email,\n  defaultBillingRate: user?.defaultBillingRate,\n  defaultCostRate: user?.defaultCostRate,\n  billingRateResolved: billingRate,\n  costRateResolved: costRate,\n  timestamp: new Date().toISOString()\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 2427):\n\n```typescript\nconsole.log(\"[DIAGNOSTIC] User lookup for error message:\", {\n  personId,\n  personIdLength: personId?.length,\n  found: !!user,\n  name: user?.name,\n  email: user?.email,\n  defaultBillingRate: user?.defaultBillingRate,\n  defaultCostRate: user?.defaultCostRate,\n  billingRateResolved: billingRate,\n  costRateResolved: costRate,\n  timestamp: new Date().toISOString()\n})\n```\n"},{"hash":"d5151681b71a24f5926a095503498d0f","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":1091,"col":7},"end":{"line":1098,"col":9},"lines":"console.log(\"[EMAIL_HEADER_UPLOAD] User context:\", {\n  id: user?.id,\n  email: user?.email,\n  role: user?.role,\n  platformRole: user?.platformRole,\n  primaryTenantId: user?.primaryTenantId,\n  tenantId: user?.tenantId\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 1091):\n\n```typescript\nconsole.log(\"[EMAIL_HEADER_UPLOAD] User context:\", {\n  id: user?.id,\n  email: user?.email,\n  role: user?.role,\n  platformRole: user?.platformRole,\n  primaryTenantId: user?.primaryTenantId,\n  tenantId: user?.tenantId\n})\n```\n"},{"hash":"d55f7d9b6f4b8dfcac28694ddbbad96b","ruleIds":["AUTH-TOKEN"],"message":"Auth Token exposed to Microsoft Microsoft","severity":"CRITICAL","location":{"path":"server/services/planner-graph-client.ts","start":{"line":106,"col":10},"end":{"line":110,"col":5},"lines":"       Client.initWithMiddleware({\n  authProvider: {\n    getAccessToken: async () => accessToken,\n  },\n})"},"privacyViolations":["GDPR-A5-28","CCPA","NIST-800-53"],"remediationStrategy":"warning","remediationSummary":"Verify that shared data aligns with the sensitive data types defined in your privacy notice and data processing agreement. Adjust or restrict sharing as necessary to maintain compliance and minimize privacy risks."},{"hash":"6c518f63c3b46c06f4e5cff71f78c94c","ruleIds":["ENCRYPTION-KEY"],"message":"Encryption Key exposed to Standard Output Standard Output","severity":"CRITICAL","location":{"path":"test-sharepoint-upload.js","start":{"line":32,"col":3},"end":{"line":32,"col":148},"lines":"console.log('- Auth method:', process.env.AZURE_CERTIFICATE_PRIVATE_KEY ? 'Certificate' : process.env.AZURE_CLIENT_SECRET ? 'Secret' : 'MISSING')"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `test-sharepoint-upload.js` (line 32):\n\n```typescript\nconsole.log('- Auth method:', process.env.AZURE_CERTIFICATE_PRIVATE_KEY ? 'Certificate' : process.env.AZURE_CLIENT_SECRET ? 'Secret' : 'MISSING')\n```\n"},{"hash":"8a58fdf515567246fab90dca63a3a13b","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":714,"col":9},"end":{"line":714,"col":70},"lines":"console.log('[EXPENSE_ACCESS] Expense not found:', expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 714):\n\n```typescript\nconsole.log('[EXPENSE_ACCESS] Expense not found:', expenseId)\n```\n"},{"hash":"36efdd90f42ad27954ab3bb590d2f6fe","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/db-session-store.ts","start":{"line":96,"col":5},"end":{"line":102,"col":7},"lines":"console.log(\"[DB-SESSION] Created new session:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  email: userData.email,\n  ssoProvider: ssoData?.provider || 'regular',\n  durationHours,\n  expiresAt\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/db-session-store.ts` (line 96):\n\n```typescript\nconsole.log(\"[DB-SESSION] Created new session:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  email: userData.email,\n  ssoProvider: ssoData?.provider || 'regular',\n  durationHours,\n  expiresAt\n})\n```\n"},{"hash":"d4e09c7a6c93031bfb4ff3d85dcd891b","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/invoices.ts","start":{"line":964,"col":15},"end":{"line":964,"col":103},"lines":"console.warn(`[RECEIPTS_BUNDLE] Timeout fetching receipt URL for expense ${expense.id}`)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/invoices.ts` (line 964):\n\n```typescript\nconsole.warn(`[RECEIPTS_BUNDLE] Timeout fetching receipt URL for expense ${expense.id}`)\n```\n"},{"hash":"ac1e1015c97fb6b8fc9986426f4f7833","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"client/src/pages/expense-management.tsx","start":{"line":615,"col":5},"end":{"line":615,"col":75},"lines":"console.log(\"[EXPENSE_EDIT] Selected expense ID:\", selectedExpense.id)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/expense-management.tsx` (line 615):\n\n```typescript\nconsole.log(\"[EXPENSE_EDIT] Selected expense ID:\", selectedExpense.id)\n```\n"},{"hash":"54c61fa8b6b93707a06e771583806786","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":3975,"col":11},"end":{"line":3979,"col":13},"lines":"console.log('[PLANNER] Looking up Azure user for allocation:', {\n  personId: allocation.personId,\n  personEmail: allocation.person?.email,\n  personName: allocation.person?.name\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 3975):\n\n```typescript\nconsole.log('[PLANNER] Looking up Azure user for allocation:', {\n  personId: allocation.personId,\n  personEmail: allocation.person?.email,\n  personName: allocation.person?.name\n})\n```\n"},{"hash":"cd947e9895293d0a24c1f62a4fa3dae2","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"client/src/pages/expenses.tsx","start":{"line":699,"col":17},"end":{"line":699,"col":87},"lines":"console.warn(`Receipt upload error for expense ${expense.id}:`, error)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/expenses.tsx` (line 699):\n\n```typescript\nconsole.warn(`Receipt upload error for expense ${expense.id}:`, error)\n```\n"},{"hash":"d1486bd7e9a156f95ad38098438e8874","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/auth-routes.ts","start":{"line":81,"col":9},"end":{"line":81,"col":81},"lines":"console.error(\"[AUTH] Failed to resolve tenant for user:\", dbUser.email)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/auth-routes.ts` (line 81):\n\n```typescript\nconsole.error(\"[AUTH] Failed to resolve tenant for user:\", dbUser.email)\n```\n"},{"hash":"8eb54809027761ea1d2a0f37701bd7a4","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4454,"col":29},"end":{"line":4454,"col":78},"lines":"console.log('[PLANNER] Azure user email:', email)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4454):\n\n```typescript\nconsole.log('[PLANNER] Azure user email:', email)\n```\n"},{"hash":"e96ff0b725e2455afe32e2c3426b1543","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/storage.ts","start":{"line":1113,"col":5},"end":{"line":1113,"col":67},"lines":"console.log(\"[DIAGNOSTIC] getUserByEmail called with:\", email)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 1113):\n\n```typescript\nconsole.log(\"[DIAGNOSTIC] getUserByEmail called with:\", email)\n```\n"},{"hash":"e557c163c62b56e19e83dcb6f2151e9a","ruleIds":["AUTH-TOKEN"],"message":"Auth Token exposed to Standard Output Standard Output","severity":"CRITICAL","location":{"path":"server/routes.ts","start":{"line":9548,"col":7},"end":{"line":9553,"col":9},"lines":"console.log(\"[SSO-CALLBACK] Token details:\", {\n  hasAccessToken: !!tokenResponse.accessToken,\n  hasRefreshToken: !!(tokenResponse as any).refreshToken,\n  expiresOn: tokenResponse.expiresOn,\n  scopes: tokenResponse.scopes\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 9548):\n\n```typescript\nconsole.log(\"[SSO-CALLBACK] Token details:\", {\n  hasAccessToken: !!tokenResponse.accessToken,\n  hasRefreshToken: !!(tokenResponse as any).refreshToken,\n  expiresOn: tokenResponse.expiresOn,\n  scopes: tokenResponse.scopes\n})\n```\n"},{"hash":"aafdb084bd51474d7288520ea1338b41","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4022,"col":19},"end":{"line":4022,"col":120},"lines":"console.log('[PLANNER] Auto-discovery failed - no Azure AD user found for:', allocation.person.email)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4022):\n\n```typescript\nconsole.log('[PLANNER] Auto-discovery failed - no Azure AD user found for:', allocation.person.email)\n```\n"},{"hash":"5db803b531ecf4f8b019670c47609d40","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/services/time-reminder-scheduler.ts","start":{"line":196,"col":9},"end":{"line":196,"col":76},"lines":"console.log(`[TIME-REMINDERS] Sent reminder to ${recipient.email}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/services/time-reminder-scheduler.ts` (line 196):\n\n```typescript\nconsole.log(`[TIME-REMINDERS] Sent reminder to ${recipient.email}`)\n```\n"},{"hash":"47c5a877c396bb1b42b054f67f7d4ef3","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":9547,"col":7},"end":{"line":9547,"col":83},"lines":"console.log(\"[SSO-CALLBACK] Token exchange successful for user:\", userEmail)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 9547):\n\n```typescript\nconsole.log(\"[SSO-CALLBACK] Token exchange successful for user:\", userEmail)\n```\n"},{"hash":"63bca70407575c510257002489d172ba","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/invoices.ts","start":{"line":953,"col":17},"end":{"line":953,"col":111},"lines":"console.warn(`[RECEIPTS_BUNDLE] Downloaded file exceeds size limit for expense ${expense.id}`)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/invoices.ts` (line 953):\n\n```typescript\nconsole.warn(`[RECEIPTS_BUNDLE] Downloaded file exceeds size limit for expense ${expense.id}`)\n```\n"},{"hash":"21bbd8d6eb00fbf5efc236bde0228920","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":535,"col":7},"end":{"line":535,"col":79},"lines":"console.log(\"[EXPENSE_DELETE] Expense deleted successfully:\", expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 535):\n\n```typescript\nconsole.log(\"[EXPENSE_DELETE] Expense deleted successfully:\", expenseId)\n```\n"},{"hash":"3be764aa77eea49340c201a751de39d5","ruleIds":["PHONE-NUMBER","EMAIL"],"message":"Email and Phone Number exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/scripts/migrate-settings-to-tenant.ts","start":{"line":44,"col":11},"end":{"line":44,"col":88},"lines":"console.log(`  Will migrate: ${setting.settingKey} -> tenant.${tenantField}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/scripts/migrate-settings-to-tenant.ts` (line 44):\n\n```typescript\nconsole.log(`  Will migrate: ${setting.settingKey} -> tenant.${tenantField}`)\n```\n"},{"hash":"e943713ea34299bebcc1e6711327ed8d","ruleIds":["AUTH-TOKEN"],"message":"Auth Token exposed to Microsoft Microsoft","severity":"CRITICAL","location":{"path":"server/services/sharepoint-client.ts","start":{"line":42,"col":10},"end":{"line":46,"col":5},"lines":"       Client.initWithMiddleware({\n  authProvider: {\n    getAccessToken: async () => accessToken\n  }\n})"},"privacyViolations":["GDPR-A5-28","CCPA","NIST-800-53"],"remediationStrategy":"warning","remediationSummary":"Verify that shared data aligns with the sensitive data types defined in your privacy notice and data processing agreement. Adjust or restrict sharing as necessary to maintain compliance and minimize privacy risks."},{"hash":"b2fb0ff15c88fb150a0928161f4a77c2","ruleIds":["EMAIL","USERNAME"],"message":"Email and Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/storage.ts","start":{"line":1120,"col":5},"end":{"line":1128,"col":7},"lines":"console.log(\"[DIAGNOSTIC] getUserByEmail result:\", {\n  emailSearched: email,\n  found: !!user,\n  userId: user?.id,\n  userEmail: user?.email,\n  userName: user?.name,\n  defaultBillingRate: user?.defaultBillingRate,\n  defaultCostRate: user?.defaultCostRate\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 1120):\n\n```typescript\nconsole.log(\"[DIAGNOSTIC] getUserByEmail result:\", {\n  emailSearched: email,\n  found: !!user,\n  userId: user?.id,\n  userEmail: user?.email,\n  userName: user?.name,\n  defaultBillingRate: user?.defaultBillingRate,\n  defaultCostRate: user?.defaultCostRate\n})\n```\n"},{"hash":"9b8bd76c7ae4d7a33b1427edcd23d466","ruleIds":["PHONE-NUMBER"],"message":"Phone Number exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/scripts/migrate-settings-to-tenant.ts","start":{"line":74,"col":5},"end":{"line":74,"col":66},"lines":"console.log(`  companyPhone: ${updatedTenant?.companyPhone}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/scripts/migrate-settings-to-tenant.ts` (line 74):\n\n```typescript\nconsole.log(`  companyPhone: ${updatedTenant?.companyPhone}`)\n```\n"},{"hash":"f5f3ccac3d4f93b2b7815f9007d78ede","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":3995,"col":15},"end":{"line":3995,"col":113},"lines":"console.log('[PLANNER] No mapping found, attempting auto-discovery for:', allocation.person.email)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 3995):\n\n```typescript\nconsole.log('[PLANNER] No mapping found, attempting auto-discovery for:', allocation.person.email)\n```\n"},{"hash":"e71f77c9d71ca593c8ddc8da01913cac","ruleIds":["AUTH-TOKEN"],"message":"Auth Token exposed to Microsoft Microsoft","severity":"CRITICAL","location":{"path":"server/services/outlook-client.ts","start":{"line":45,"col":10},"end":{"line":49,"col":5},"lines":"       Client.initWithMiddleware({\n  authProvider: {\n    getAccessToken: async () => accessToken\n  }\n})"},"privacyViolations":["GDPR-A5-28","CCPA","NIST-800-53"],"remediationStrategy":"warning","remediationSummary":"Verify that shared data aligns with the sensitive data types defined in your privacy notice and data processing agreement. Adjust or restrict sharing as necessary to maintain compliance and minimize privacy risks."},{"hash":"074731c7a7480db0d5d65d5989db7eee","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/db-session-store.ts","start":{"line":25,"col":7},"end":{"line":29,"col":9},"lines":"console.log(\"[DB-SESSION] Session expired and removed:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  expiresAt: session.expiresAt,\n  email: session.email\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/db-session-store.ts` (line 25):\n\n```typescript\nconsole.log(\"[DB-SESSION] Session expired and removed:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  expiresAt: session.expiresAt,\n  email: session.email\n})\n```\n"},{"hash":"75c92c22bd2c37458624590ccf345434","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/auth-routes.ts","start":{"line":27,"col":7},"end":{"line":27,"col":86},"lines":"console.log(\"[AUTH] Login attempt:\", { email, NODE_ENV: process.env.NODE_ENV })"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/auth-routes.ts` (line 27):\n\n```typescript\nconsole.log(\"[AUTH] Login attempt:\", { email, NODE_ENV: process.env.NODE_ENV })\n```\n"},{"hash":"e8479c423e11981e17a24584476bb2ce","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"client/src/pages/expenses.tsx","start":{"line":695,"col":19},"end":{"line":695,"col":82},"lines":"console.warn(`Receipt upload failed for expense ${expense.id}`)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/expenses.tsx` (line 695):\n\n```typescript\nconsole.warn(`Receipt upload failed for expense ${expense.id}`)\n```\n"},{"hash":"e82b2d2a2ec718d18e75425ca5dddd0a","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":9565,"col":7},"end":{"line":9569,"col":9},"lines":"console.log(\"[SSO-CALLBACK] Found user in database:\", {\n  id: dbUser.id,\n  email: dbUser.email,\n  role: dbUser.role\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 9565):\n\n```typescript\nconsole.log(\"[SSO-CALLBACK] Found user in database:\", {\n  id: dbUser.id,\n  email: dbUser.email,\n  role: dbUser.role\n})\n```\n"},{"hash":"9fa7c19cdebcfd0a6194ac94d45331e4","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/invoices.ts","start":{"line":932,"col":13},"end":{"line":932,"col":95},"lines":"console.warn(`[RECEIPTS_BUNDLE] Skipping non-https URL for expense ${expense.id}`)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/invoices.ts` (line 932):\n\n```typescript\nconsole.warn(`[RECEIPTS_BUNDLE] Skipping non-https URL for expense ${expense.id}`)\n```\n"},{"hash":"2e84d10474ea755184114a8b215040b3","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/storage.ts","start":{"line":12033,"col":17},"end":{"line":12033,"col":106},"lines":"console.error(`[PDF] Failed to fetch receipt from URL for expense ${expense.id}:`, error)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 12033):\n\n```typescript\nconsole.error(`[PDF] Failed to fetch receipt from URL for expense ${expense.id}:`, error)\n```\n"},{"hash":"c247cb815d5948513539011fab140156","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":423,"col":7},"end":{"line":423,"col":109},"lines":"console.log(\"[EXPENSE UPDATE] Request for expense:\", expenseId, \"by user:\", userId, \"role:\", userRole)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 423):\n\n```typescript\nconsole.log(\"[EXPENSE UPDATE] Request for expense:\", expenseId, \"by user:\", userId, \"role:\", userRole)\n```\n"},{"hash":"b3c333ba9730ad6ccb74ea5d9101f113","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":432,"col":9},"end":{"line":432,"col":80},"lines":"console.error(\"[EXPENSE UPDATE] Access denied for expense:\", expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 432):\n\n```typescript\nconsole.error(\"[EXPENSE UPDATE] Access denied for expense:\", expenseId)\n```\n"},{"hash":"0715b1b6288a56df8c0816917fb1edb9","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":9561,"col":9},"end":{"line":9561,"col":79},"lines":"console.error(\"[SSO-CALLBACK] User not found in database:\", userEmail)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 9561):\n\n```typescript\nconsole.error(\"[SSO-CALLBACK] User not found in database:\", userEmail)\n```\n"},{"hash":"101629bd4d3ffd8cdd2a0cb8a57d9f13","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":177,"col":9},"end":{"line":177,"col":99},"lines":"console.error(`[EXPENSE-REMINDERS] Failed to send reminder to ${recipient.email}:`, error)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/services/expense-reminder-scheduler.ts` (line 177):\n\n```typescript\nconsole.error(`[EXPENSE-REMINDERS] Failed to send reminder to ${recipient.email}:`, error)\n```\n"},{"hash":"a30e0074f969a66247a5497524886dd1","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":401,"col":7},"end":{"line":401,"col":80},"lines":"console.log(\"[EXPENSE_CREATE] Expense created successfully:\", expense.id)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 401):\n\n```typescript\nconsole.log(\"[EXPENSE_CREATE] Expense created successfully:\", expense.id)\n```\n"},{"hash":"4780390208b5a6ef92ea12d4c345f199","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":428,"col":9},"end":{"line":428,"col":72},"lines":"console.error(\"[EXPENSE UPDATE] Expense not found:\", expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 428):\n\n```typescript\nconsole.error(\"[EXPENSE UPDATE] Expense not found:\", expenseId)\n```\n"},{"hash":"abe04fe349763810d0040cbb4242aad5","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":696,"col":9},"end":{"line":696,"col":130},"lines":"console.error('[EXPENSE_ACCESS] Invalid parameters:', { expenseId: !!expenseId, userId: !!userId, userRole: !!userRole })"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 696):\n\n```typescript\nconsole.error('[EXPENSE_ACCESS] Invalid parameters:', { expenseId: !!expenseId, userId: !!userId, userRole: !!userRole })\n```\n"},{"hash":"178e546a1b8223b42fc060d98ed74f01","ruleIds":["EMAIL","USERNAME"],"message":"Email and Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":7944,"col":7},"end":{"line":7953,"col":9},"lines":"console.log(\"[DIAGNOSTIC] Authenticated user full details:\", {\n  id: req.user?.id,\n  email: req.user?.email,\n  name: req.user?.name,\n  role: req.user?.role,\n  isActive: req.user?.isActive,\n  sessionSize: sessions.size,\n  timestamp: new Date().toISOString()\n  // Note: rates are not stored in session, they're fetched from DB when needed\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 7944):\n\n```typescript\nconsole.log(\"[DIAGNOSTIC] Authenticated user full details:\", {\n  id: req.user?.id,\n  email: req.user?.email,\n  name: req.user?.name,\n  role: req.user?.role,\n  isActive: req.user?.isActive,\n  sessionSize: sessions.size,\n  timestamp: new Date().toISOString()\n  // Note: rates are not stored in session, they're fetched from DB when needed\n})\n```\n"},{"hash":"d8df936251756e8492feb536d14a17f9","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/storage.ts","start":{"line":6867,"col":11},"end":{"line":6867,"col":123},"lines":"console.warn(`[STORAGE] Skipping time entry ${timeEntry.id} for user ${user.name} - no billing rate configured`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 6867):\n\n```typescript\nconsole.warn(`[STORAGE] Skipping time entry ${timeEntry.id} for user ${user.name} - no billing rate configured`)\n```\n"},{"hash":"51b58f3b4921c7918dd9776adb5f5b1d","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/invoices.ts","start":{"line":970,"col":11},"end":{"line":970,"col":107},"lines":"console.error(`[RECEIPTS_BUNDLE] Failed to fetch receipt URL for expense ${expense.id}:`, error)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/invoices.ts` (line 970):\n\n```typescript\nconsole.error(`[RECEIPTS_BUNDLE] Failed to fetch receipt URL for expense ${expense.id}:`, error)\n```\n"},{"hash":"c3d1f3828815177f474666560b778bdc","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/auth/sso-token-refresh.ts","start":{"line":85,"col":13},"end":{"line":88,"col":15},"lines":"console.warn(\"[SSO-REFRESH] Refresh token expired, user needs to re-authenticate:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  userEmail: session.email\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/auth/sso-token-refresh.ts` (line 85):\n\n```typescript\nconsole.warn(\"[SSO-REFRESH] Refresh token expired, user needs to re-authenticate:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  userEmail: session.email\n})\n```\n"},{"hash":"bf7a6c1d4cacd02e08fce6e2588c7368","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4276,"col":23},"end":{"line":4276,"col":110},"lines":"console.log('[PLANNER] Found existing Constellation user by email:', existingUser.name)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4276):\n\n```typescript\nconsole.log('[PLANNER] Found existing Constellation user by email:', existingUser.name)\n```\n"},{"hash":"2ad49723769d5f72ece3f66760f7c8e8","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":435,"col":7},"end":{"line":435,"col":178},"lines":"console.log(\"[EXPENSE UPDATE] Found existing expense:\", existingExpense.id, \"personId:\", existingExpense.personId, \"projectResourceId:\", existingExpense.projectResourceId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 435):\n\n```typescript\nconsole.log(\"[EXPENSE UPDATE] Found existing expense:\", existingExpense.id, \"personId:\", existingExpense.personId, \"projectResourceId:\", existingExpense.projectResourceId)\n```\n"},{"hash":"91120f712596e2aba35bc39502bec14d","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/auth/sso-token-refresh.ts","start":{"line":69,"col":9},"end":{"line":73,"col":11},"lines":"console.log(\"[SSO-REFRESH] Token near expiry, attempting refresh:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  userEmail: session.email,\n  currentExpiry: session.ssoTokenExpiry\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/auth/sso-token-refresh.ts` (line 69):\n\n```typescript\nconsole.log(\"[SSO-REFRESH] Token near expiry, attempting refresh:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  userEmail: session.email,\n  currentExpiry: session.ssoTokenExpiry\n})\n```\n"},{"hash":"71fb47f631dc05ebe5fa92af2cdb84e2","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":459,"col":9},"end":{"line":459,"col":97},"lines":"console.error(\"[EXPENSE UPDATE] CRITICAL: Expense disappeared after update!\", expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 459):\n\n```typescript\nconsole.error(\"[EXPENSE UPDATE] CRITICAL: Expense disappeared after update!\", expenseId)\n```\n"},{"hash":"3859052a8cbdb8a20bd0235c432c9b26","ruleIds":["ENCRYPTION-KEY","BIOMETRICS"],"message":"Biometrics and Encryption Key exposed via Azure Azure","severity":"CRITICAL","location":{"path":"server/auth/entra-config.ts","start":{"line":135,"col":5},"end":{"line":135,"col":50},"lines":"new ConfidentialClientApplication(msalConfig)"},"privacyViolations":["GDPR-A5-28","CCPA","HIPAA","NIST-800-53"],"remediationStrategy":"warning","remediationSummary":"Verify that shared data aligns with the sensitive data types defined in your privacy notice and data processing agreement. Adjust or restrict sharing as necessary to maintain compliance and minimize privacy risks."},{"hash":"bd8a635e6b2144efdb752fe34272b6a6","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/services/time-reminder-scheduler.ts","start":{"line":199,"col":9},"end":{"line":199,"col":96},"lines":"console.error(`[TIME-REMINDERS] Failed to send reminder to ${recipient.email}:`, error)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/services/time-reminder-scheduler.ts` (line 199):\n\n```typescript\nconsole.error(`[TIME-REMINDERS] Failed to send reminder to ${recipient.email}:`, error)\n```\n"},{"hash":"bbeca5bade8519d7a2ed80e94c73974b","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"client/src/pages/expenses.tsx","start":{"line":782,"col":9},"end":{"line":782,"col":49},"lines":"console.log('Expense created:', expense)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/expenses.tsx` (line 782):\n\n```typescript\nconsole.log('Expense created:', expense)\n```\n"},{"hash":"0f8e1beef008df643e98f5676f97f446","ruleIds":["EMAIL","USERNAME"],"message":"Email and Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":1045,"col":7},"end":{"line":1049,"col":9},"lines":"console.log(\"[TEST_EMAIL] Starting test email send\", {\n  userEmail: user?.email,\n  userName: user?.name,\n  tenantId: tenantId\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 1045):\n\n```typescript\nconsole.log(\"[TEST_EMAIL] Starting test email send\", {\n  userEmail: user?.email,\n  userName: user?.name,\n  tenantId: tenantId\n})\n```\n"},{"hash":"6fa60003275f59974e48b7818fc13eb5","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"client/src/pages/expenses.tsx","start":{"line":1308,"col":5},"end":{"line":1308,"col":42},"lines":"console.log('Expense ID:', expenseId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/expenses.tsx` (line 1308):\n\n```typescript\nconsole.log('Expense ID:', expenseId)\n```\n"},{"hash":"4740b573ea5cdd74e98ea2e35fdecff7","ruleIds":["BUDGET"],"message":"Budget exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"client/src/pages/project-detail.tsx","start":{"line":1735,"col":3},"end":{"line":1749,"col":5},"lines":"console.log('[PROJECT_DETAIL] Analytics loaded:', {\n  projectId: id,\n  projectName: project?.name,\n  hasProject: !!project,\n  hasClient: !!project?.client,\n  clientName: project?.client?.name,\n  monthlyMetricsCount: monthlyMetrics?.length,\n  monthlyMetricsMonths: monthlyMetrics?.map(m => m.month),\n  teamHoursCount: teamHours?.length,\n  burnRate: {\n    totalBudget: burnRate.totalBudget,\n    consumedBudget: burnRate.consumedBudget,\n    burnRatePercentage: burnRate.burnRatePercentage\n  }\n})"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/project-detail.tsx` (line 1735):\n\n```typescript\nconsole.log('[PROJECT_DETAIL] Analytics loaded:', {\n  projectId: id,\n  projectName: project?.name,\n  hasProject: !!project,\n  hasClient: !!project?.client,\n  clientName: project?.client?.name,\n  monthlyMetricsCount: monthlyMetrics?.length,\n  monthlyMetricsMonths: monthlyMetrics?.map(m => m.month),\n  teamHoursCount: teamHours?.length,\n  burnRate: {\n    totalBudget: burnRate.totalBudget,\n    consumedBudget: burnRate.consumedBudget,\n    burnRatePercentage: burnRate.burnRatePercentage\n  }\n})\n```\n"},{"hash":"903888ea94203b222635c55523820b0a","ruleIds":["ENCRYPTION-KEY","BIOMETRICS"],"message":"Biometrics and Encryption Key exposed to Standard Output Standard Output","severity":"CRITICAL","location":{"path":"server/auth/entra-config.ts","start":{"line":120,"col":1},"end":{"line":131,"col":3},"lines":"console.log(\"[ENTRA-CONFIG] Azure AD Configuration:\", {\n  configured: isConfigured,\n  clientId: process.env.AZURE_CLIENT_ID || defaultClientId,\n  tenantId: process.env.AZURE_TENANT_ID || defaultTenantId,\n  authMethod: hasCertificateAuth ? 'certificate' : 'client-secret',\n  hasCertificate: hasCertificateAuth,\n  hasSecret: !!process.env.AZURE_CLIENT_SECRET,\n  baseUrl,\n  redirectUri: REDIRECT_URI,\n  environment: process.env.NODE_ENV || 'development',\n  replitDomains: process.env.REPLIT_DOMAINS || 'none'\n})"},"privacyViolations":["GDPR-A5-32","CCPA","HIPAA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/auth/entra-config.ts` (line 120):\n\n```typescript\nconsole.log(\"[ENTRA-CONFIG] Azure AD Configuration:\", {\n  configured: isConfigured,\n  clientId: process.env.AZURE_CLIENT_ID || defaultClientId,\n  tenantId: process.env.AZURE_TENANT_ID || defaultTenantId,\n  authMethod: hasCertificateAuth ? 'certificate' : 'client-secret',\n  hasCertificate: hasCertificateAuth,\n  hasSecret: !!process.env.AZURE_CLIENT_SECRET,\n  baseUrl,\n  redirectUri: REDIRECT_URI,\n  environment: process.env.NODE_ENV || 'development',\n  replitDomains: process.env.REPLIT_DOMAINS || 'none'\n})\n```\n"},{"hash":"b77b9cdb49b5bb630f2fec4aaffb2bb9","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/auth-routes.ts","start":{"line":238,"col":7},"end":{"line":238,"col":108},"lines":"console.log(`[SIGNUP] New tenant created: ${newTenant.name} (${newTenant.slug}) by ${newUser.email}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/auth-routes.ts` (line 238):\n\n```typescript\nconsole.log(`[SIGNUP] New tenant created: ${newTenant.name} (${newTenant.slug}) by ${newUser.email}`)\n```\n"},{"hash":"ee3f8166bb86fac9edb3cb4fc43f7cac","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/invoices.ts","start":{"line":946,"col":17},"end":{"line":946,"col":125},"lines":"console.warn(`[RECEIPTS_BUNDLE] Skipping oversized file (${contentLength} bytes) for expense ${expense.id}`)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/invoices.ts` (line 946):\n\n```typescript\nconsole.warn(`[RECEIPTS_BUNDLE] Skipping oversized file (${contentLength} bytes) for expense ${expense.id}`)\n```\n"},{"hash":"99ac5e8252571398edc0e96224a7fdfe","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"client/src/pages/expenses.tsx","start":{"line":1179,"col":5},"end":{"line":1190,"col":7},"lines":"console.log('Editing expense:', {\n  id: expense.id,\n  description: expense.description,\n  category: expense.category,\n  amount: expense.amount,\n  date: expense.date,\n  quantity: expense.quantity,\n  unit: expense.unit,\n  vendor: expense.vendor,\n  billable: expense.billable,\n  reimbursable: expense.reimbursable\n})"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `client/src/pages/expenses.tsx` (line 1179):\n\n```typescript\nconsole.log('Editing expense:', {\n  id: expense.id,\n  description: expense.description,\n  category: expense.category,\n  amount: expense.amount,\n  date: expense.date,\n  quantity: expense.quantity,\n  unit: expense.unit,\n  vendor: expense.vendor,\n  billable: expense.billable,\n  reimbursable: expense.reimbursable\n})\n```\n"},{"hash":"182bf64fd86ca117bfe4964cd5415623","ruleIds":["USERNAME"],"message":"Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/routes.ts","start":{"line":4459,"col":31},"end":{"line":4459,"col":118},"lines":"console.log('[PLANNER] Found existing Constellation user by email:', existingUser.name)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 4459):\n\n```typescript\nconsole.log('[PLANNER] Found existing Constellation user by email:', existingUser.name)\n```\n"},{"hash":"550ec770c7700298c055235a30492b26","ruleIds":["AUTH-TOKEN","EMAIL"],"message":"Auth Token and Email exposed to Standard Output Standard Output","severity":"CRITICAL","location":{"path":"server/session-store.ts","start":{"line":242,"col":3},"end":{"line":249,"col":5},"lines":"console.log(\"[AUTH] Session valid:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  user: req.user?.email,\n  role: req.user?.role,\n  tenantId: req.user?.tenantId?.substring(0, 8) || 'none',\n  ssoProvider: req.user?.ssoProvider || 'none',\n  hasRefreshToken: !!req.user?.ssoRefreshToken\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/session-store.ts` (line 242):\n\n```typescript\nconsole.log(\"[AUTH] Session valid:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  user: req.user?.email,\n  role: req.user?.role,\n  tenantId: req.user?.tenantId?.substring(0, 8) || 'none',\n  ssoProvider: req.user?.ssoProvider || 'none',\n  hasRefreshToken: !!req.user?.ssoRefreshToken\n})\n```\n"},{"hash":"cb1c51cae4de7e78524d02e232f7875f","ruleIds":["EMAIL"],"message":"Email exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/services/email-notification.ts","start":{"line":71,"col":7},"end":{"line":71,"col":80},"lines":"console.log(`[EMAIL] Sent email via SendGrid to ${to.email}: ${subject}`)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/services/email-notification.ts` (line 71):\n\n```typescript\nconsole.log(`[EMAIL] Sent email via SendGrid to ${to.email}: ${subject}`)\n```\n"},{"hash":"a923daeca8b7593711fe3dfb816a549e","ruleIds":["AUTH-TOKEN"],"message":"Auth Token exposed to Standard Output Standard Output","severity":"CRITICAL","location":{"path":"server/routes.ts","start":{"line":9585,"col":7},"end":{"line":9589,"col":9},"lines":"console.log(\"[SSO-CALLBACK] Creating session:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  hasRefreshToken: !!ssoData.refreshToken,\n  tokenExpiry: ssoData.tokenExpiry\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes.ts` (line 9585):\n\n```typescript\nconsole.log(\"[SSO-CALLBACK] Creating session:\", {\n  sessionId: sessionId.substring(0, 8) + '...',\n  hasRefreshToken: !!ssoData.refreshToken,\n  tokenExpiry: ssoData.tokenExpiry\n})\n```\n"},{"hash":"cae8d74a3fb17013c2c7a9c1c1325bfb","ruleIds":["AUTH-TOKEN"],"message":"Auth Token exposed to Standard Output Standard Output","severity":"CRITICAL","location":{"path":"server/services/ai-provider.ts","start":{"line":54,"col":7},"end":{"line":54,"col":178},"lines":"console.error('[AI_PROVIDER] Replit AI not configured. BASE_URL:', !!process.env.AI_INTEGRATIONS_OPENAI_BASE_URL, 'API_KEY:', !!process.env.AI_INTEGRATIONS_OPENAI_API_KEY)"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/services/ai-provider.ts` (line 54):\n\n```typescript\nconsole.error('[AI_PROVIDER] Replit AI not configured. BASE_URL:', !!process.env.AI_INTEGRATIONS_OPENAI_BASE_URL, 'API_KEY:', !!process.env.AI_INTEGRATIONS_OPENAI_API_KEY)\n```\n"},{"hash":"d304e1bd676aca9eec4e0303b4b41ad4","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/routes/expenses.ts","start":{"line":478,"col":7},"end":{"line":478,"col":99},"lines":"console.log(\"[EXPENSE_DELETE] Attempting to delete expense:\", expenseId, \"by user:\", userId)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/routes/expenses.ts` (line 478):\n\n```typescript\nconsole.log(\"[EXPENSE_DELETE] Attempting to delete expense:\", expenseId, \"by user:\", userId)\n```\n"},{"hash":"fe6565fb5eddedd92deee5d8bd9fd0d4","ruleIds":["EMAIL","USERNAME"],"message":"Email and Username exposed to Standard Output Standard Output","severity":"LOW","location":{"path":"server/storage.ts","start":{"line":2576,"col":7},"end":{"line":2587,"col":9},"lines":"console.log(\"[DIAGNOSTIC] User lookup for error message:\", {\n  personId,\n  personIdLength: personId?.length,\n  found: !!user,\n  name: user?.name,\n  email: user?.email,\n  defaultBillingRate: user?.defaultBillingRate,\n  defaultCostRate: user?.defaultCostRate,\n  billingRateResolved: billingRate,\n  costRateResolved: costRate,\n  timestamp: new Date().toISOString()\n})"},"privacyViolations":["GDPR-A5-32","CCPA","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 2576):\n\n```typescript\nconsole.log(\"[DIAGNOSTIC] User lookup for error message:\", {\n  personId,\n  personIdLength: personId?.length,\n  found: !!user,\n  name: user?.name,\n  email: user?.email,\n  defaultBillingRate: user?.defaultBillingRate,\n  defaultCostRate: user?.defaultCostRate,\n  billingRateResolved: billingRate,\n  costRateResolved: costRate,\n  timestamp: new Date().toISOString()\n})\n```\n"},{"hash":"0e911626ced551f5c9f81cf74786d996","ruleIds":["EXPENSE"],"message":"Expense exposed to Standard Output Standard Output","severity":"MEDIUM","location":{"path":"server/storage.ts","start":{"line":7212,"col":5},"end":{"line":7212,"col":237},"lines":"console.log(`[STORAGE] Resync billed flags: ${expensesSynced} expenses synced, ${timeEntriesSynced} time entries synced, ${expensesAlreadyCorrect} expenses already correct, ${timeEntriesAlreadyCorrect} time entries already correct`)"},"privacyViolations":["GDPR-A5-32","CCPA","PCI","NIST-800-53"],"remediationStrategy":"deletion","remediationSummary":"Delete the offending code.","remediationPrompt":"Delete the offending code in `server/storage.ts` (line 7212):\n\n```typescript\nconsole.log(`[STORAGE] Resync billed flags: ${expensesSynced} expenses synced, ${timeEntriesSynced} time entries synced, ${expensesAlreadyCorrect} expenses already correct, ${timeEntriesAlreadyCorrect} time entries already correct`)\n```\n"}]}}