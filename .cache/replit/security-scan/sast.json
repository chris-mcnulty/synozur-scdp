{"schemaVersion":1,"gitHash":"d170df27c4cf973761c3dfde97db95ec52590a81","writtenAt":"2026-02-20T21:26:37.333Z","data":[{"location":{"path":".local/state/replit/agent/design_reference/da45da1b-65ee-4a88-9a13-8c02f4f23184/d96917a8-bc0b-42fa-971d-17df85410ff9.html","start":{"line":6,"col":5},"end":{"line":6,"col":56},"lines":"    <script src=\"https://cdn.tailwindcss.com\"></script>"},"checkId":".config.replit..semgrep.vendored-rules.html.security.audit.missing-integrity","message":"This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you’re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.","severity":"MEDIUM","fingerprint":"1f15c8eb260f793c981c0a18014824c251fcc237661ebd94c66b12fb74e0dcf25a719dbf0de9b6e08cc783d450f4fb0b1c1ea9fb49437b486879d17d4d7efa5a_0"},{"location":{"path":".local/state/replit/agent/design_reference/da45da1b-65ee-4a88-9a13-8c02f4f23184/d96917a8-bc0b-42fa-971d-17df85410ff9.html","start":{"line":169,"col":5},"end":{"line":169,"col":109},"lines":"    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\" rel=\"stylesheet\">"},"checkId":".config.replit..semgrep.vendored-rules.html.security.audit.missing-integrity","message":"This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you’re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.","severity":"MEDIUM","fingerprint":"b42b7dd31c504da55d7e1112fee1cfb2c827bcd8a3a0a5d86e15e0cabc6a7bdfb4faa036c5d962ff2495e29356e656da828de226f780124fec201a76bdfb16a8_0"},{"location":{"path":"archive/corrupted/routes-backup-corrupted.ts","start":{"line":497,"col":16},"end":{"line":497,"col":31},"lines":"      res.send(fileData.buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"add442089f27248c9ec3c81e79dc86ab5446306415b69bcd47a6ba246247a10ce8a0c200a1660424f76f875dca42fb9933eda87c482291f95ebc18c58d8f8b76_0"},{"location":{"path":"archive/corrupted/routes-backup-corrupted.ts","start":{"line":4212,"col":27},"end":{"line":4212,"col":86},"lines":"            console.error(`[BULK_UPLOAD] Failed to process file ${file.originalname}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"fadb64585c7dbf7b397b66d8e3fa7bce487c4a1b60f0740c90cd6b5dfce24c57533c84d052c6362c7012821578df60358989a5ab20b2ea95a922d5a0053cbbb1_0"},{"location":{"path":"archive/corrupted/routes-backup-corrupted.ts","start":{"line":4567,"col":29},"end":{"line":4567,"col":88},"lines":"              console.error(`[ERROR] Failed to fetch line items for estimate ${est.id}:`, lineItemError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"bc3f7868d840b2b6885deee34e96ac4b0842818a389f47b0036f6c86a101b31fb2ef51678b4a19b3a8678ae04de86018d4ff04c68b5ba62f08b067abfe3b60e9_0"},{"location":{"path":"archive/corrupted/routes-backup-corrupted.ts","start":{"line":4588,"col":25},"end":{"line":4588,"col":71},"lines":"          console.error(`[ERROR] Failed to process estimate ${est.id}:`, estError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"40aba8a589f8245f818265608027d3155e8455e307a1acf0c6860bcf3f813bfbdecd5200e79c648faecc895f649e6052a5339db04b547d4ebf9222d0f6ccd493_0"},{"location":{"path":"archive/corrupted/routes-corrupted.ts","start":{"line":491,"col":16},"end":{"line":491,"col":31},"lines":"      res.send(fileData.buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"d55ac7c0f8382fc61996a9801a0dfbc319ea60205be68e25435fa35d3d61259ad120a06b09ab27429c7704e5d10c8dbeb7787e3bee10148877fb3a98098613e9_0"},{"location":{"path":"archive/corrupted/routes-corrupted.ts","start":{"line":3916,"col":18},"end":{"line":3916,"col":39},"lines":"        res.send(downloadResult.buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"44d47a988bdcfecd239599b48bd43f586e7f4e530a6bd0cb4bdcb4518ae2874fdba65621f70f6c15bed33367df10526f3d2a32ae41c7023508aef37921fb4c43_0"},{"location":{"path":"archive/corrupted/routes-corrupted.ts","start":{"line":4206,"col":27},"end":{"line":4206,"col":86},"lines":"            console.error(`[BULK_UPLOAD] Failed to process file ${file.originalname}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"f8a79fd84b9fe537671b4ed4d69501bf6ac93f757feeefef9e4cb2c10f75b9a7d3d9ffd8ca70ad385b69f026591c26292872ffd6a4f79c00d9504ba3d4844775_0"},{"location":{"path":"archive/corrupted/routes-corrupted.ts","start":{"line":4471,"col":16},"end":{"line":4471,"col":34},"lines":"      res.send(fileContent.buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"35b9895843474928414ff3348967e0f1559765640929dd4c69baa47a1db30ef9fa5a76a9bc39488696f1fc0fe2066a415b2afd7e1f37a30aee6ce5487e9fc865_0"},{"location":{"path":"archive/corrupted/routes-corrupted.ts","start":{"line":4561,"col":29},"end":{"line":4561,"col":88},"lines":"              console.error(`[ERROR] Failed to fetch line items for estimate ${est.id}:`, lineItemError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"30a869a49933c857ab7e3b02a7d506d4e9e54de4b1169c648878708e03787f791f79abb0978d5f3e12b53d8fd0ff061e6a025d0b87bcf1532b8a0609b80ce4c2_0"},{"location":{"path":"archive/corrupted/routes-corrupted.ts","start":{"line":4582,"col":25},"end":{"line":4582,"col":71},"lines":"          console.error(`[ERROR] Failed to process estimate ${est.id}:`, estError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"7dda25b9513981af2bf303661ab82744507789fcd0bce6118683a33081c7753ebe3ba8b9e71dfeba8cfb84a507f15efd57d1927379e08c9891619fc46782b8d1_0"},{"location":{"path":"archive/scripts/migration/test-azure-setup.cjs","start":{"line":44,"col":68},"end":{"line":44,"col":72},"lines":"  const missingFiles = requiredFiles.filter(file => !fs.existsSync(file));"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `file` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"2f7eee005df668ad37b1004fd4e9d1d194137c83c92b87c79d1f50cb3f485c5082134fc9d858f3e80f40d3d5f15ed92c4f7c9c9c8bf35ebdeb2fe199faa76d75_0"},{"location":{"path":"archive/scripts/recovery/recover-time-entries-production.ts","start":{"line":86,"col":22},"end":{"line":86,"col":30},"lines":"  if (!fs.existsSync(filePath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filePath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"d9b640177f40b1d5efd49ab6e7a2da6c3c1729dd0a2b4fe57cf17316f305bdd6cd38deb8241dc08b0d27f3c4d4f6c73f50992f58f371c5e684280e1e5dd8ac50_0"},{"location":{"path":"archive/scripts/recovery/recover-time-entries-production.ts","start":{"line":178,"col":21},"end":{"line":178,"col":78},"lines":"      console.error(`Error transforming entry ${index + 1} (ID: ${entry.id}):`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"ba59bca95b946e694a3b22abd330809826bf1d19443db89e787b019d3a5025dbcdf0fdce041287327c759f27fb0121a7a9bb235313cce7cdda9ef6cd1c96390d_0"},{"location":{"path":"archive/scripts/recovery/recover-time-entries.ts","start":{"line":82,"col":22},"end":{"line":82,"col":30},"lines":"  if (!fs.existsSync(filePath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filePath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"5738f9e160e36853eea5ff070bc7cfdbd8590ecce30a68e920bcdb81b36bfeaf5aa2d641004878937a511cdc18fefb8a5de016e79966cb13bf6dfdc186b73b0d_0"},{"location":{"path":"archive/scripts/recovery/recover-time-entries.ts","start":{"line":124,"col":21},"end":{"line":124,"col":78},"lines":"      console.error(`Error transforming entry ${index + 1} (ID: ${entry.id}):`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"cf873ba675f26a4782ce2629474928cffddaf3768d80cf09ed1bc2bb74072a797bbc8bbb5147ff87f687036dd7682865d203467f0faf5f2bbacd95c24ee257da_0"},{"location":{"path":"client/index.html","start":{"line":16,"col":5},"end":{"line":16,"col":101},"lines":"    <script type=\"text/javascript\" src=\"https://replit.com/public/js/replit-dev-banner.js\"></script>"},"checkId":".config.replit..semgrep.vendored-rules.html.security.audit.missing-integrity","message":"This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you’re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.","severity":"MEDIUM","fingerprint":"70c1dd5bd64ef35713bb965281d8beb5e45019fc5b018b19692e7a078591ec18880ce0bf42a6be03cc525c95e41cdc8e6939107a9516425c829bf4ee0dbbc09f_0"},{"location":{"path":"client/src/components/status-report-dialog.tsx","start":{"line":450,"col":50},"end":{"line":450,"col":78},"lines":"  return <div dangerouslySetInnerHTML={{ __html: `<p class=\"mb-3\">${html}</p>` }} />;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"2169ebaa78ad9597219a501e1346487ab08169d5f3e9ebdae0dcf440c69d7353658312d0b6c2b06cebc8ff38caeaf3323893979fbb352cd334dbbd4410ae5254_0"},{"location":{"path":"client/src/pages/expenses.tsx","start":{"line":699,"col":30},"end":{"line":699,"col":78},"lines":"                console.warn(`Receipt upload error for expense ${expense.id}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"d8eff81a99686a44e700cb3577d1ba57cd37e5edf1da64ff99371a8ad9d6f271cfb63f2e2553fc13b520df53d61d53766ac048a915352fe855bde93d869114eb_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":19,"col":32},"end":{"line":19,"col":35},"lines":"  const exists = fs.existsSync(src);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `src` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"cbfbf5900ce38bdec0b31ae120a5d7f011589b26d4a24ea0b82be0c53edd6acfbeb0390fab02e576fa7791a8525ff32bc6823c6c45274caa48f710ebf3586442_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":20,"col":39},"end":{"line":20,"col":42},"lines":"  const stats = exists && fs.statSync(src);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `src` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"cbfbf5900ce38bdec0b31ae120a5d7f011589b26d4a24ea0b82be0c53edd6acfbeb0390fab02e576fa7791a8525ff32bc6823c6c45274caa48f710ebf3586442_1"},{"location":{"path":"scripts/copy-dist.js","start":{"line":25,"col":24},"end":{"line":25,"col":28},"lines":"    if (!fs.existsSync(dest)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dest` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"99da22d6e5e49fc9990d416ac3cd1909eb5265e371d365e903af344c095becdb35c510aefc2e7755b8704a6449bcfff410a732492d528a9da67dd893997d4cbe_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":26,"col":20},"end":{"line":26,"col":24},"lines":"      fs.mkdirSync(dest, { recursive: true });"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dest` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"99da22d6e5e49fc9990d416ac3cd1909eb5265e371d365e903af344c095becdb35c510aefc2e7755b8704a6449bcfff410a732492d528a9da67dd893997d4cbe_1"},{"location":{"path":"scripts/copy-dist.js","start":{"line":30,"col":20},"end":{"line":30,"col":23},"lines":"    fs.readdirSync(src).forEach(childItemName => {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `src` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"cbfbf5900ce38bdec0b31ae120a5d7f011589b26d4a24ea0b82be0c53edd6acfbeb0390fab02e576fa7791a8525ff32bc6823c6c45274caa48f710ebf3586442_2"},{"location":{"path":"scripts/copy-dist.js","start":{"line":32,"col":19},"end":{"line":32,"col":22},"lines":"        path.join(src, childItemName),"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"3d2eda5331f624c7e20da414ab97381b8de2c70d1622b797f2ef85af4f0f3daffbcfbcd799d0b4147a7850d4373e82459f1a28eae2f966d0b0505d0d47dafd22_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":32,"col":24},"end":{"line":32,"col":37},"lines":"        path.join(src, childItemName),"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"626ed1e98c7a4b06f0dcb78e46981eeebbb528f6b232515b2bd797c9c7416f9311a4aab37466ebf364218455fe02b42cb564d9abc467249ca3aa365d26ee1d90_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":33,"col":19},"end":{"line":33,"col":23},"lines":"        path.join(dest, childItemName)"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"47a03ee7a007f48c110295a645e54e6c0991c5456c7fd82585ecc31f0846e3231ed56e247b7567d1ab4749b86a44646a749154a0596587bb36cfec2c3b34ea4d_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":33,"col":25},"end":{"line":33,"col":38},"lines":"        path.join(dest, childItemName)"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"626ed1e98c7a4b06f0dcb78e46981eeebbb528f6b232515b2bd797c9c7416f9311a4aab37466ebf364218455fe02b42cb564d9abc467249ca3aa365d26ee1d90_1"},{"location":{"path":"scripts/copy-dist.js","start":{"line":39,"col":24},"end":{"line":39,"col":33},"lines":"    if (!fs.existsSync(parentDir)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dest` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"b3f1e1606643cee426d35e55e068a93a8452bed126ce8bdd319cdbd38d883aa51a576c9698caf690e77f3e10eea449d0bcb8a4880feaf4f01939a37d60db42dd_0"},{"location":{"path":"scripts/copy-dist.js","start":{"line":40,"col":20},"end":{"line":40,"col":29},"lines":"      fs.mkdirSync(parentDir, { recursive: true });"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dest` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"b3f1e1606643cee426d35e55e068a93a8452bed126ce8bdd319cdbd38d883aa51a576c9698caf690e77f3e10eea449d0bcb8a4880feaf4f01939a37d60db42dd_1"},{"location":{"path":"scripts/copy-dist.js","start":{"line":44,"col":21},"end":{"line":44,"col":24},"lines":"    fs.copyFileSync(src, dest);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `src` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"cbfbf5900ce38bdec0b31ae120a5d7f011589b26d4a24ea0b82be0c53edd6acfbeb0390fab02e576fa7791a8525ff32bc6823c6c45274caa48f710ebf3586442_3"},{"location":{"path":"scripts/copy-dist.js","start":{"line":44,"col":26},"end":{"line":44,"col":30},"lines":"    fs.copyFileSync(src, dest);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dest` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"38df36021497ccc67ad76782e1ed39af2de9dfd389017324e79eb03c3e1b4ddcf08fd0439efe609f42299d21fcf52b58bbb03acd21828716356d56da49b72fee_0"},{"location":{"path":"scripts/ingest-oconus-rates.ts","start":{"line":29,"col":22},"end":{"line":29,"col":35},"lines":"  if (!fs.existsSync(targetZipPath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `zipPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"4d17d3be7276334e185d74681364a01d5877fea0fef4b6ff54d1c43bd61b5d2588bbbbd87e9baf524ff1215aebd74d45d384119a18bcf157b22adccaef38c88c_0"},{"location":{"path":"scripts/ingest-oconus-rates.ts","start":{"line":39,"col":12},"end":{"line":39,"col":56},"lines":"  execSync(`unzip -o \"${targetZipPath}\" -d \"${tempDir}\"`, { stdio: \"pipe\" });"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.detect-child-process","message":"Detected calls to child_process from a function argument `zipPath`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ","severity":"HIGH","fingerprint":"b656179079145660b27f8a1b43bf435374ba3b3e7df9fd2ed4154f6fdb3803a85961e79b20f5de17e074a384a1b1a47f608654d7c963a32575437294b78fab0a_0"},{"location":{"path":"server/auth/entra-config.ts","start":{"line":4,"col":26},"end":{"line":4,"col":62},"lines":"const defaultClientId = \"198aa0a6-d2ed-4f35-b41b-b6f6778a30d6\"; // SCDP-Content owning app"},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"8540c0743ee04a960a63903a4d28fa4de96c13b226fe385f77e3d68fb1b987d04ede274a76623bf72b0d976bf2fc204f4b63591d05fa5ed71490b1b280a16e40_0"},{"location":{"path":"server/email-support.ts","start":{"line":19,"col":11},"end":{"line":53,"col":5},"lines":"    html: `\n      <!DOCTYPE html>\n      <html>\n        <head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"></head>\n        <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #0a0a0a; color: #ffffff;\">\n          <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"background-color: #0a0a0a;\">\n            <tr>\n              <td style=\"padding: 40px 20px;\">\n                <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"max-width: 600px; margin: 0 auto; background-color: #1a1a1a; border-radius: 12px; overflow: hidden;\">\n                  <tr>\n                    <td style=\"padding: 30px 40px; background: ${ticket.priority === 'high' ? '#dc2626' : ticket.priority === 'medium' ? '#d97706' : '#2563eb'};\">\n                      <h1 style=\"margin: 0; font-size: 20px; color: #ffffff;\">New Support Ticket #${ticket.ticketNumber}</h1>\n                      <p style=\"margin: 5px 0 0; font-size: 14px; color: rgba(255,255,255,0.8);\">${(ticket.priority || 'medium').toUpperCase()} priority ${ticket.category.replace('_', ' ')}</p>\n                    </td>\n                  </tr>\n                  <tr>\n                    <td style=\"padding: 30px 40px;\">\n                      <table style=\"width: 100%; border-collapse: collapse; margin: 0 0 20px;\">\n                        <tr><td style=\"padding: 8px 12px; font-size: 13px; color: #888; border-bottom: 1px solid #333;\">Application</td><td style=\"padding: 8px 12px; font-size: 13px; color: #e0e0e0; border-bottom: 1px solid #333;\">Constellation</td></tr>\n                        <tr><td style=\"padding: 8px 12px; font-size: 13px; color: #888; border-bottom: 1px solid #333;\">User</td><td style=\"padding: 8px 12px; font-size: 13px; color: #e0e0e0; border-bottom: 1px solid #333;\">${userName} (${user.email})</td></tr>\n                        <tr><td style=\"padding: 8px 12px; font-size: 13px; color: #888;\">Subject</td><td style=\"padding: 8px 12px; font-size: 13px; color: #e0e0e0;\">${ticket.subject}</td></tr>\n                      </table>\n                      <div style=\"padding: 16px; background: #111; border-radius: 8px; margin: 0 0 20px;\">\n                        <p style=\"margin: 0; font-size: 13px; color: #ccc; white-space: pre-wrap;\">${ticket.description}</p>\n                      </div>\n                      <a href=\"${APP_URL}/support\" style=\"display: inline-block; padding: 12px 24px; background: #2563eb; color: #ffffff; text-decoration: none; border-radius: 8px; font-size: 14px;\">View in Constellation</a>\n                    </td>\n                  </tr>\n                </table>\n              </td>\n            </tr>\n          </table>\n        </body>\n      </html>\n    `,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"5b232e1143553168c6a9bb9eef24aba729f2fc123a1ac46251e4940d9af5dc852aeb4c3fde7dc77a19292416753e57d95815147a153886d4c2386fdc3b11f481_0"},{"location":{"path":"server/email-support.ts","start":{"line":70,"col":11},"end":{"line":106,"col":5},"lines":"    html: `\n      <!DOCTYPE html>\n      <html>\n        <head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"></head>\n        <body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f5f5f5; color: #333;\">\n          <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"background-color: #f5f5f5;\">\n            <tr>\n              <td style=\"padding: 40px 20px;\">\n                <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\">\n                  <tr>\n                    <td style=\"padding: 30px 40px; background: #2563eb;\">\n                      <h1 style=\"margin: 0; font-size: 20px; color: #ffffff;\">Support Ticket Received</h1>\n                      <p style=\"margin: 5px 0 0; font-size: 14px; color: rgba(255,255,255,0.8);\">Ticket #${ticket.ticketNumber}</p>\n                    </td>\n                  </tr>\n                  <tr>\n                    <td style=\"padding: 30px 40px;\">\n                      <p style=\"margin: 0 0 16px; font-size: 14px; color: #333;\">Hi ${userName},</p>\n                      <p style=\"margin: 0 0 16px; font-size: 14px; color: #333;\">Thank you for reaching out. We've received your support ticket and our team will review it shortly.</p>\n                      <table style=\"width: 100%; border-collapse: collapse; margin: 0 0 20px; background: #f9fafb; border-radius: 8px;\">\n                        <tr><td style=\"padding: 10px 14px; font-size: 13px; color: #666; border-bottom: 1px solid #e5e7eb;\">Ticket #</td><td style=\"padding: 10px 14px; font-size: 13px; color: #333; border-bottom: 1px solid #e5e7eb; font-weight: 600;\">${ticket.ticketNumber}</td></tr>\n                        <tr><td style=\"padding: 10px 14px; font-size: 13px; color: #666; border-bottom: 1px solid #e5e7eb;\">Subject</td><td style=\"padding: 10px 14px; font-size: 13px; color: #333; border-bottom: 1px solid #e5e7eb;\">${ticket.subject}</td></tr>\n                        <tr><td style=\"padding: 10px 14px; font-size: 13px; color: #666; border-bottom: 1px solid #e5e7eb;\">Category</td><td style=\"padding: 10px 14px; font-size: 13px; color: #333; border-bottom: 1px solid #e5e7eb;\">${ticket.category.replace('_', ' ')}</td></tr>\n                        <tr><td style=\"padding: 10px 14px; font-size: 13px; color: #666;\">Priority</td><td style=\"padding: 10px 14px; font-size: 13px; color: #333;\">${(ticket.priority || 'medium').charAt(0).toUpperCase() + (ticket.priority || 'medium').slice(1)}</td></tr>\n                      </table>\n                      <p style=\"margin: 0 0 20px; font-size: 14px; color: #333;\">You can track your ticket status and add updates anytime:</p>\n                      <a href=\"${APP_URL}/support\" style=\"display: inline-block; padding: 12px 24px; background: #2563eb; color: #ffffff; text-decoration: none; border-radius: 8px; font-size: 14px;\">View Your Ticket</a>\n                      <p style=\"margin: 20px 0 0; font-size: 13px; color: #888;\">You'll receive another email when your ticket is resolved.</p>\n                    </td>\n                  </tr>\n                </table>\n              </td>\n            </tr>\n          </table>\n        </body>\n      </html>\n    `,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"738aeeb8b8bc3b00df314561a374219128df83c9f83aed316394046caccdc00ba53938c8bf4168a8107ef85def38c9775f6f7aefa226731e9266511460f0d462_0"},{"location":{"path":"server/fix-time-entry-rates.ts","start":{"line":49,"col":19},"end":{"line":49,"col":72},"lines":"    console.error(`  ⚠️  Error getting rates for entry ${entry.id}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"13e316ffb8d6a286b32fa757024834d3240cda09f752f9b2f22e20df91962923004b3fbbadcfb89de4dc5443d68a5180dfc0b7d767464ada79c7886dc71ef8e0_0"},{"location":{"path":"server/gsa-service.ts","start":{"line":336,"col":19},"end":{"line":336,"col":77},"lines":"    console.error(`[GSA_API] Error fetching GSA rates for ${city}, ${state}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"6f9084d6d9b896bc542c4abd3f1e0cbfe7720e3978923928773161c9b31259bd60dc09c07c7381fd78eb7fe604a61f3c1d6752dfd31f784c6c73c092579f19a6_0"},{"location":{"path":"server/gsa-service.ts","start":{"line":415,"col":19},"end":{"line":415,"col":60},"lines":"    console.error(`Error fetching GSA rates for ZIP ${zip}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"a9a434c7851db81401f6cc9c8fd907342b1988516a41693742559af2523708d2b0ed0f6b8139a140c460bcf8df9e921be7b558c7bbd3bcdf15a9e471ca02bad4_0"},{"location":{"path":"server/routes/estimates.ts","start":{"line":3972,"col":29},"end":{"line":3972,"col":66},"lines":"              console.error(`Failed to create epic \"${epicName}\":`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"0c1372d88f4875841a5e85a8d28ad7aae736571cc951df56e23a3d376c9df927ce1d776eb177cecbbe074a759d66a4a2334dd9a941647037c8e00f0bd23f113a_0"},{"location":{"path":"server/routes/estimates.ts","start":{"line":3994,"col":29},"end":{"line":3994,"col":68},"lines":"              console.error(`Failed to create stage \"${stageName}\":`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9ccd80cec86c45edcbb82481b222d7085027945101e678ba985e68b9ade462765fa7d27d038f6fe73f998585b35ca8ead5b7f981d94344d4e863e2193328af6a_0"},{"location":{"path":"server/routes/estimates.ts","start":{"line":4227,"col":25},"end":{"line":4227,"col":48},"lines":"            console.log(`Skipping row ${i + 1}:`, skipReason);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"06f8810fce6c36d40a4fdbf2be25af4bf1df7389d9dc31296456570fb9da36857e1837b3f44a92cd5e5641a89787ea9a25b4a1b3d90017210f7c2de0b368d946_0"},{"location":{"path":"server/routes/estimates.ts","start":{"line":4255,"col":29},"end":{"line":4255,"col":66},"lines":"              console.error(`Failed to create epic \"${epicName}\":`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"0c1372d88f4875841a5e85a8d28ad7aae736571cc951df56e23a3d376c9df927ce1d776eb177cecbbe074a759d66a4a2334dd9a941647037c8e00f0bd23f113a_1"},{"location":{"path":"server/routes/estimates.ts","start":{"line":4277,"col":29},"end":{"line":4277,"col":68},"lines":"              console.error(`Failed to create stage \"${stageName}\":`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9ccd80cec86c45edcbb82481b222d7085027945101e678ba985e68b9ade462765fa7d27d038f6fe73f998585b35ca8ead5b7f981d94344d4e863e2193328af6a_1"},{"location":{"path":"server/routes/expenses.ts","start":{"line":504,"col":63},"end":{"line":504,"col":85},"lines":"            message: `Cannot delete an expense with status \"${expense.approvalStatus}\". Only draft expenses can be deleted, or contact an administrator.` "},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.injection.tainted-sql-string","message":"Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.","severity":"HIGH","fingerprint":"0a503f124c17812242628ef1f6fe4056ff94bc6784c11ca359266e2fc1cf0873ffae3a7f37b6cf072b55aef40a1f88b67bff746d1319e8847f9a177d0f7a3346_0"},{"location":{"path":"server/routes/expenses.ts","start":{"line":994,"col":18},"end":{"line":994,"col":32},"lines":"        res.send(downloadBuffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"c9a30d8ccce5dfb60e5717da0a68e8d8067973b93123e54e385a8908a9367c6524b719eccb8db47333e178c5ff27afce28bd45a2a7ebdfee49337b8e19cb94fa_0"},{"location":{"path":"server/routes/expenses.ts","start":{"line":2353,"col":27},"end":{"line":2353,"col":92},"lines":"            console.error('[BULK_UPLOAD] Failed to process file ' + file.originalname + ':', error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"dc7ffa3431743d12d4ec383074e0267675d97a6101d1a061b985c3f4c7e07c6b371911ae84b9597853a68e55e9c42e969fca203fb38e11f2c7a18c06aa373188_0"},{"location":{"path":"server/routes/invoices.ts","start":{"line":919,"col":25},"end":{"line":919,"col":86},"lines":"          console.error(`[RECEIPTS_BUNDLE] Failed to download ${attachment.fileName}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"41b02c00d416e2c255e3adee108bbef52589453a71747658a958a6345f0a14e2390257ba41663a4487c379bd4ee27db501b3c614cd8396b20aafec19595d6f5d_0"},{"location":{"path":"server/routes/invoices.ts","start":{"line":970,"col":25},"end":{"line":970,"col":98},"lines":"          console.error(`[RECEIPTS_BUNDLE] Failed to fetch receipt URL for expense ${expense.id}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"90254cb98cd6758f5723b4eb5327dad71eff6283bbd1d61d690f7791ce5d1a4d88698829d7e2d6d5ce74bcf36c2968768d9513a2891d39d2877d9ad56138666e_0"},{"location":{"path":"server/routes/sharepoint-containers.ts","start":{"line":247,"col":16},"end":{"line":247,"col":31},"lines":"      res.send(fileData.buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"8e1dad561d6d3ef835b69a28b2a7090be168d872a915a4f74ff6009b5a2e25dd8ddc7b05e267d2f2fa8d18f0988a9b48f39435a48c78837f6298bdfd894e0c66_0"},{"location":{"path":"server/routes/sharepoint-containers.ts","start":{"line":439,"col":25},"end":{"line":439,"col":78},"lines":"          console.error(`[SMART_STORAGE] ${env} ❌ SharePoint upload failed:`, error instanceof Error ? error.message : error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9d7d0e3c3c35584e8aad897db50292e5e94ed7bbd3426d922fe5a12f2f10c8ff1296ff79fd9abb4e6bb81f96ddead4218064ac17d9ea5049e1eca63c454f95dc_0"},{"location":{"path":"server/routes/sharepoint-containers.ts","start":{"line":781,"col":16},"end":{"line":781,"col":31},"lines":"      res.send(fileData.buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.direct-response-write","message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","severity":"MEDIUM","fingerprint":"8e1dad561d6d3ef835b69a28b2a7090be168d872a915a4f74ff6009b5a2e25dd8ddc7b05e267d2f2fa8d18f0988a9b48f39435a48c78837f6298bdfd894e0c66_1"},{"location":{"path":"server/services/ai-provider.ts","start":{"line":96,"col":21},"end":{"line":96,"col":71},"lines":"      console.error(`[AI_PROVIDER] Replit AI error after ${duration}s:`, error.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"8b1b3f7d42f9913ca401391d8a3805fd610b5139cdce157d694f5a88de8d36b482eedfcecbd6c477db6d2a34bfe768da9b7e08448705c94452a9aee258dc4809_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":85,"col":42},"end":{"line":89,"col":5},"lines":"    const viewReportButton = reportUrl ? `\n      <p style=\"margin: 20px 0;\">\n        <a href=\"${escapeHtml(reportUrl)}\" style=\"background-color: #7C3AED; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">View Report</a>\n      </p>\n    ` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"28fda61a09e079630191c28a49039abdc856722616f69861b7fce72a78d5dc3549f0f8798924e162f1b3aadea8781fdc5832bb37cea050f3b26ae9ff8e503140_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":90,"col":18},"end":{"line":106,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #7C3AED;\">Expense Report Submitted</h2>\n          <p>Hi ${escapeHtml(submitter.name)},</p>\n          <p>Your expense report has been successfully submitted for approval:</p>\n          <div style=\"background-color: #f4f4f4; padding: 15px; border-left: 4px solid #7C3AED; margin: 20px 0;\">\n            <strong>Report Number:</strong> ${escapeHtml(reportNumber)}<br>\n            <strong>Title:</strong> ${escapeHtml(reportTitle)}\n          </div>\n          ${viewReportButton}\n          <p>You'll receive a notification once your report has been reviewed.</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":117,"col":42},"end":{"line":121,"col":5},"lines":"    const viewReportButton = reportUrl ? `\n      <p style=\"margin: 20px 0;\">\n        <a href=\"${escapeHtml(reportUrl)}\" style=\"background-color: #7C3AED; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">Review Report</a>\n      </p>\n    ` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"d4def94b3733c9840e40c60e820df29bed453caed2bce7a3702f9dae7a96066789af3a4ffee75cba2020aeedefc3a3eb40fd506a227b97a8186fd77a9c488874_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":122,"col":18},"end":{"line":140,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #7C3AED;\">Expense Report Awaiting Your Approval</h2>\n          <p>Hi ${escapeHtml(approver.name)},</p>\n          <p>A new expense report has been submitted and requires your approval:</p>\n          <div style=\"background-color: #f4f4f4; padding: 15px; border-left: 4px solid #7C3AED; margin: 20px 0;\">\n            <strong>Report Number:</strong> ${escapeHtml(reportNumber)}<br>\n            <strong>Title:</strong> ${escapeHtml(reportTitle)}<br>\n            <strong>Submitted By:</strong> ${escapeHtml(submitter.name)} (${escapeHtml(submitter.email)})<br>\n            <strong>Total Amount:</strong> ${escapeHtml(currency)} ${escapeHtml(totalAmount)}\n          </div>\n          ${viewReportButton}\n          <p>Please review this report at your earliest convenience.</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_1"},{"location":{"path":"server/services/email-notification.ts","start":{"line":152,"col":42},"end":{"line":156,"col":5},"lines":"    const viewReportButton = reportUrl ? `\n      <p style=\"margin: 20px 0;\">\n        <a href=\"${escapeHtml(reportUrl)}\" style=\"background-color: #22C55E; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">View Report</a>\n      </p>\n    ` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"a7af5ebc1b785bc108439f8bdd6a1cac01ed38e62537051329f163ec38d41077bc56776db53dd4c241de47a16ad390537eb2fef819a447a4cf57e77b98360116_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":157,"col":18},"end":{"line":175,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #22C55E;\">Expense Report Approved</h2>\n          <p>Hi ${escapeHtml(submitter.name)},</p>\n          <p>Great news! Your expense report has been approved:</p>\n          <div style=\"background-color: #f0fdf4; padding: 15px; border-left: 4px solid #22C55E; margin: 20px 0;\">\n            <strong>Report Number:</strong> ${escapeHtml(reportNumber)}<br>\n            <strong>Title:</strong> ${escapeHtml(reportTitle)}<br>\n            <strong>Approved By:</strong> ${escapeHtml(approver.name)}\n            ${escapedNote ? `<br><strong>Note:</strong> ${escapedNote}` : ''}\n          </div>\n          ${viewReportButton}\n          <p>Your expenses will be processed for reimbursement shortly.</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_2"},{"location":{"path":"server/services/email-notification.ts","start":{"line":168,"col":29},"end":{"line":168,"col":70},"lines":"            ${escapedNote ? `<br><strong>Note:</strong> ${escapedNote}` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"711530e05cba6205582b4275df142cc10bf68990788dd3d55b23cf3bc2764046cdc1ec164144249ab55c68b18c0748009e6345883b7e037c53a558f2359eb78c_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":187,"col":42},"end":{"line":191,"col":5},"lines":"    const viewReportButton = reportUrl ? `\n      <p style=\"margin: 20px 0;\">\n        <a href=\"${escapeHtml(reportUrl)}\" style=\"background-color: #EF4444; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">Edit Report</a>\n      </p>\n    ` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"b83e94ab16cc3d279f3a0fe99ec4fd196540fc218bc5ce86baff72a056cf7a2c94f107e978ffe82f82af7d938972820b5e54a951d1bdd17e6b6d21f292be22dd_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":192,"col":18},"end":{"line":210,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #EF4444;\">Expense Report Requires Revision</h2>\n          <p>Hi ${escapeHtml(submitter.name)},</p>\n          <p>Your expense report has been reviewed and requires some changes:</p>\n          <div style=\"background-color: #fef2f2; padding: 15px; border-left: 4px solid #EF4444; margin: 20px 0;\">\n            <strong>Report Number:</strong> ${escapeHtml(reportNumber)}<br>\n            <strong>Title:</strong> ${escapeHtml(reportTitle)}<br>\n            <strong>Reviewed By:</strong> ${escapeHtml(rejecter.name)}\n            ${escapedNote ? `<br><br><strong>Reason:</strong><br>${escapedNote.replace(/\\n/g, '<br>')}` : ''}\n          </div>\n          ${viewReportButton}\n          <p>Please review the feedback and resubmit your report with the necessary corrections.</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_3"},{"location":{"path":"server/services/email-notification.ts","start":{"line":203,"col":29},"end":{"line":203,"col":102},"lines":"            ${escapedNote ? `<br><br><strong>Reason:</strong><br>${escapedNote.replace(/\\n/g, '<br>')}` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"91eaf560a62862b9fa5fe92ca2a35df44050a3fa1e8bbb9d0b9a19cf25b8f244e1a58b9f31348f707a92cb8c627ee5fdea48d4012728908cf75a172fc2e34b76_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":228,"col":18},"end":{"line":244,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #7C3AED;\">Test Email</h2>\n          <p>Hi ${escapeHtml(recipient.name)},</p>\n          <p>This is a test email to verify your email branding configuration.</p>\n          <div style=\"background-color: #f4f4f4; padding: 15px; border-left: 4px solid #7C3AED; margin: 20px 0;\">\n            <strong>Company Name:</strong> ${escapeHtml(branding?.companyName || 'Not configured')}<br>\n            <strong>Email Header:</strong> ${branding?.emailHeaderUrl ? 'Configured' : 'Not configured'}\n          </div>\n          ${testButton}\n          <p>If you see your branded header at the top of this email, your configuration is working correctly!</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_4"},{"location":{"path":"server/services/email-notification.ts","start":{"line":262,"col":42},"end":{"line":266,"col":5},"lines":"    const viewTicketButton = ticketUrl ? `\n      <p style=\"margin: 20px 0;\">\n        <a href=\"${escapeHtml(ticketUrl)}\" style=\"background-color: #22C55E; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">View Ticket</a>\n      </p>\n    ` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"8a001a5e81d0c1578e4b1c4606ddf445c5276474717fa8bbaa29e27a11f236908264e0a664d29d909eb36129f9a0b3acd6d479c4677f47ba22f7f5f315c4f7c6_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":267,"col":18},"end":{"line":284,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #22C55E;\">Support Ticket Resolved</h2>\n          <p>Hi ${escapeHtml(requester.name)},</p>\n          <p>Your support ticket has been resolved:</p>\n          <div style=\"background-color: #f0fdf4; padding: 15px; border-left: 4px solid #22C55E; margin: 20px 0;\">\n            <strong>Ticket #:</strong> ${ticketNumber}<br>\n            <strong>Subject:</strong> ${escapeHtml(subject)}\n            ${resolutionNote ? `<br><br><strong>Resolution:</strong><br>${escapeHtml(resolutionNote).replace(/\\n/g, '<br>')}` : ''}\n          </div>\n          ${viewTicketButton}\n          <p>If you have any further questions or this issue persists, feel free to open a new ticket or reply.</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_5"},{"location":{"path":"server/services/email-notification.ts","start":{"line":277,"col":32},"end":{"line":277,"col":124},"lines":"            ${resolutionNote ? `<br><br><strong>Resolution:</strong><br>${escapeHtml(resolutionNote).replace(/\\n/g, '<br>')}` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"1383fc6ea97e8606bc1030765dd0f7980b833bc506fc619615c6acb7fe11477c21a7f732df684193ae9a2e4eada7b070738d173d98ba823c2f178a2d6227e137_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":309,"col":16},"end":{"line":316,"col":9},"lines":"        return `\n          <tr>\n            <td style=\"padding: 8px 12px; border-bottom: 1px solid #e5e7eb;\">${escapeHtml(dateStr)}</td>\n            <td style=\"padding: 8px 12px; border-bottom: 1px solid #e5e7eb; text-transform: capitalize;\">${escapeHtml(exp.category)}</td>\n            <td style=\"padding: 8px 12px; border-bottom: 1px solid #e5e7eb;\">${escapeHtml(exp.description)}</td>\n            <td style=\"padding: 8px 12px; border-bottom: 1px solid #e5e7eb; text-align: right;\">${escapeHtml(exp.currency)} ${escapeHtml(parseFloat(exp.amount).toFixed(2))}</td>\n          </tr>\n        `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"ae439f59a8ebdf06bebf2fed4080c893134e72c5a6e3d5c1c35f14a111cf1882d0d4fe61108d833f4bf3e6451ec2748bc0f06a2775ce7d7c5faa6aa0ec62fa71_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":319,"col":26},"end":{"line":337,"col":7},"lines":"      expenseTableHtml = `\n        <table style=\"width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px;\">\n          <thead>\n            <tr style=\"background-color: #f3f4f6;\">\n              <th style=\"padding: 10px 12px; text-align: left; border-bottom: 2px solid #e5e7eb;\">Date</th>\n              <th style=\"padding: 10px 12px; text-align: left; border-bottom: 2px solid #e5e7eb;\">Category</th>\n              <th style=\"padding: 10px 12px; text-align: left; border-bottom: 2px solid #e5e7eb;\">Description</th>\n              <th style=\"padding: 10px 12px; text-align: right; border-bottom: 2px solid #e5e7eb;\">Amount</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${rows}\n            <tr style=\"font-weight: bold; background-color: #f9fafb;\">\n              <td colspan=\"3\" style=\"padding: 10px 12px; text-align: right; border-top: 2px solid #e5e7eb;\">Total:</td>\n              <td style=\"padding: 10px 12px; text-align: right; border-top: 2px solid #e5e7eb;\">${escapeHtml(currency)} ${escapeHtml(parseFloat(totalAmount).toFixed(2))}</td>\n            </tr>\n          </tbody>\n        </table>\n      `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"7dc219fae18267d6dafc2d20d39c5b517d319c7fd42fd303c2d4e18ce963576e45d2e45e8769e41d49481d13b5d26b9d504f54e5de8b797c4b89120bca648a56_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":341,"col":9},"end":{"line":341,"col":87},"lines":"      ? `<strong>Payment Reference:</strong> ${escapeHtml(paymentReferenceNumber)}<br>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"98f6c1ffd98084224c5aa2ede163888577dfdcaa2bb7b22ee7ea8f8c77a3b67b701cd06e7188cdeadb6bbc60fde1f8bf0df03dc90560635e68be29c7f59beda4_0"},{"location":{"path":"server/services/email-notification.ts","start":{"line":344,"col":18},"end":{"line":362,"col":5},"lines":"    const body = `\n      <html>\n        <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n          ${header}\n          <h2 style=\"color: #7C3AED;\">Reimbursement Processed</h2>\n          <p>Hi ${escapeHtml(employee.name)},</p>\n          <p>Your approved expenses have been processed for reimbursement:</p>\n          <div style=\"background-color: #f4f4f4; padding: 15px; border-left: 4px solid #7C3AED; margin: 20px 0;\">\n            <strong>Batch Number:</strong> ${escapeHtml(batchNumber)}<br>\n            ${referenceHtml}\n            <strong>Total Amount:</strong> ${escapeHtml(currency)} ${escapeHtml(parseFloat(totalAmount).toFixed(2))}<br>\n            <strong>Number of Expenses:</strong> ${expenseCount}\n          </div>\n          ${expenseTableHtml}\n          <p>You can expect payment according to your organization's reimbursement schedule.</p>\n          <p>Thank you,<br>${escapeHtml(branding?.companyName || 'Synozur Consulting Delivery Platform')}</p>\n        </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"21ca449468c651eacb51fac5086b4d9005ba523c58dd5904131870d7588473964eea383aab451ff3a5fe17ed280c647ec0a88e023318ce6181720b7494139b23_6"},{"location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":79,"col":7},"end":{"line":79,"col":163},"lines":"    ? `<img src=\"${branding.emailHeaderUrl}\" alt=\"${escapeHtml(branding.companyName || 'Company')}\" style=\"max-width: 100%; height: auto; margin-bottom: 20px;\" />`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"054be4ce5d8a2db14e71f02c994d28f6a9061f4c168bc239a3bd497c33dd903074365ddae739bcceab5823cb75829cdf8ad690c8ec07cbb8908b85c17ecced39_0"},{"location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":84,"col":16},"end":{"line":105,"col":3},"lines":"  const body = `\n    <html>\n      <body style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n        ${headerHtml}\n        <h2 style=\"color: #7C3AED;\">Expense Submission Reminder</h2>\n        <p>Hi ${escapeHtml(recipient.name)},</p>\n        <p>This is a friendly reminder that you have <strong>${count} expense${count === 1 ? '' : 's'}</strong> that ${count === 1 ? 'has' : 'have'} not been added to an expense report for approval.</p>\n        <p style=\"background-color: #f4f4f4; padding: 15px; border-left: 4px solid #7C3AED; margin: 20px 0;\">\n          To get reimbursed, please add your expenses to an expense report and submit it for approval.\n        </p>\n        <p>\n          <a href=\"${appUrl}/expenses\" style=\"display: inline-block; background-color: #7C3AED; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; margin: 10px 0;\">\n            Review My Expenses\n          </a>\n        </p>\n        <p style=\"color: #666; font-size: 0.9em; margin-top: 30px;\">\n          You can disable these reminders in your personal settings if you prefer not to receive them.\n        </p>\n        <p>Thank you,<br>${branding?.companyName || 'Synozur Consulting Delivery Platform'}</p>\n      </body>\n    </html>\n  `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"93712c58ffd28767f8469e489fb1cfe2b9d4f7dceb87084a9ad09a8e50bd576f75804035a05dc4e4c5dacf8042d834fad0c1b53a10d7a67b08f10a7763af5397_0"},{"location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":177,"col":23},"end":{"line":177,"col":90},"lines":"        console.error(`[EXPENSE-REMINDERS] Failed to send reminder to ${recipient.email}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"0a8f4b20f296197d869a21f5c0e0d38fb71b9de79356dec7ab09d1f1f5529c3c7bc8db905c287e3fe03e8ce714b0c6ae22b741370e20ed01a3dfda2c16242dff_0"},{"location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":192,"col":19},"end":{"line":192,"col":74},"lines":"    console.error(`[EXPENSE-REMINDERS] Job failed for tenant ${tenantId}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9466f731f30a811860327727b36cb24b7d37034ce75d0a9f396c6bcf5319ad2f1bb34c754e7d4e2556e5fcf9757acd8444cc9d2869c4970f4a0b17c7d59ba794_0"},{"location":{"path":"server/services/expense-reminder-scheduler.ts","start":{"line":250,"col":21},"end":{"line":250,"col":75},"lines":"      console.error(`[EXPENSE-REMINDERS] Failed for tenant ${tenant.name}:`, err.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"8b4cc4f2a7b0f65f4e47c740d0be09eac54aefa10f5ca9f7af18a54770278fb7589ae7141329c1002cb136dbd2a55e9788281fcdc043d83355671405c244ea46_0"},{"location":{"path":"server/services/graph-client.ts","start":{"line":206,"col":20},"end":{"line":206,"col":76},"lines":"      console.warn(`[GraphClient] Failed to fetch container ${containerId}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"129739ba30b1690b05791646f705cac0dc2ee42913ad426c9c49f7cad1247374e13ee46954d8a28e864c893f30f548eac05ffc759e04a401449d2d1473bb9c66_0"},{"location":{"path":"server/services/graph-client.ts","start":{"line":349,"col":22},"end":{"line":349,"col":134},"lines":"        console.warn(`[GraphClient] ${operationName} failed (attempt ${retryCount + 1}/${this.maxRetries}). Retrying in ${delay}ms...`, error.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9c17892b4b2bbe191ba1821374ba60495686dc0d9f396d8df0a52f3a37eafaaa69f7d52b09fbf80dfddf1fc3ff6d77d1cc1b7d3fb5812c7088b298736d547a20_0"},{"location":{"path":"server/services/graph-client.ts","start":{"line":355,"col":21},"end":{"line":355,"col":93},"lines":"      console.error(`[GraphClient] ${operationName} failed after ${retryCount + 1} attempts:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"57017a2e36c8dd61f154f08f11fb262571f35e6ee342f7f18939423c86adc31c3047f8bdfe9ca354831e61c66b5e894c05d634b64d33c1a31fda417cf3e01759_0"},{"location":{"path":"server/services/graph-client.ts","start":{"line":875,"col":22},"end":{"line":875,"col":134},"lines":"        console.warn(`[GraphClient] ${operationName} failed (attempt ${retryCount + 1}/${this.maxRetries}). Retrying in ${delay}ms...`, error.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9c17892b4b2bbe191ba1821374ba60495686dc0d9f396d8df0a52f3a37eafaaa69f7d52b09fbf80dfddf1fc3ff6d77d1cc1b7d3fb5812c7088b298736d547a20_1"},{"location":{"path":"server/services/graph-client.ts","start":{"line":881,"col":21},"end":{"line":881,"col":93},"lines":"      console.error(`[GraphClient] ${operationName} failed after ${retryCount + 1} attempts:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"57017a2e36c8dd61f154f08f11fb262571f35e6ee342f7f18939423c86adc31c3047f8bdfe9ca354831e61c66b5e894c05d634b64d33c1a31fda417cf3e01759_1"},{"location":{"path":"server/services/graph-client.ts","start":{"line":1562,"col":26},"end":{"line":1562,"col":94},"lines":"            console.warn(`[GraphClient] Could not retrieve existing column ${columnDef.name}:`, getError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"1c1e72643bf308a472fde3acd01ec06007c271df524a4d23a59b3fd7bd08f172def30da87b7cb93b269488439cb02c2d8fa727db145569403c22502449b9b554_0"},{"location":{"path":"server/services/graph-client.ts","start":{"line":1565,"col":25},"end":{"line":1565,"col":99},"lines":"          console.error(`[GraphClient] Failed to create receipt metadata column ${columnDef.name}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"185a4637ce214b41c1703920dccba5044899aa5adc717b02b0bd0e2c03cbeefac01070ecea47048af33259e4db56bf79ebfd61d273cef4efa8a597ed568db3d6_0"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":169,"col":43},"end":{"line":169,"col":51},"lines":"    const filePath = path.join(uploadDir, filename);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"d3629f80c46b355011d836187593283cfe34e7e9d895e7cf20826925a01be4d2096101d3cb9291bac79a48036c66cd8672e9d091f1ba21b6517b9f7e202b3e1b_0"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":170,"col":24},"end":{"line":170,"col":32},"lines":"    await fs.writeFile(filePath, buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filename` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"481806fdb00d92ad794d5527a05bc9a0d5a7e9d45346c9684d3059902e693841098dc26303a606ee6a050021b1b71c8e403b54172c1c9e325447c072eedff122_0"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":175,"col":34},"end":{"line":175,"col":42},"lines":"    return path.join('invoices', filename);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"d3629f80c46b355011d836187593283cfe34e7e9d895e7cf20826925a01be4d2096101d3cb9291bac79a48036c66cd8672e9d091f1ba21b6517b9f7e202b3e1b_1"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":179,"col":58},"end":{"line":179,"col":64},"lines":"    const filePath = path.join(process.cwd(), 'uploads', fileId);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"87bc62046e3538a904e833e44b78aed0a475bd506ecea512343260d2b406440ec7b57d1f4f864eda3d66ca8e6399263e0154980f7d253b0d5b9e1118e36e6875_0"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":180,"col":30},"end":{"line":180,"col":38},"lines":"    return await fs.readFile(filePath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"8df01173fce3916f16b32e212bb31a73506ed12753faf0cfd37bc6e7cf4b8a55c8204cba1da415fdde47640bf641782857ab19543e7342708d736185af505483_0"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":184,"col":58},"end":{"line":184,"col":64},"lines":"    const filePath = path.join(process.cwd(), 'uploads', fileId);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"87bc62046e3538a904e833e44b78aed0a475bd506ecea512343260d2b406440ec7b57d1f4f864eda3d66ca8e6399263e0154980f7d253b0d5b9e1118e36e6875_1"},{"location":{"path":"server/services/invoice-pdf-storage.ts","start":{"line":185,"col":21},"end":{"line":185,"col":29},"lines":"    await fs.unlink(filePath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"8df01173fce3916f16b32e212bb31a73506ed12753faf0cfd37bc6e7cf4b8a55c8204cba1da415fdde47640bf641782857ab19543e7342708d736185af505483_1"},{"location":{"path":"server/services/job-catchup-service.ts","start":{"line":89,"col":27},"end":{"line":89,"col":74},"lines":"            console.error(`[JOB-CATCHUP] Failed to run ${config.jobType}:`, runError.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"dd0df542ac26610f86158e7b4e5748757961f361be1fd36db77bc8aa47a1391ac01ef7879ae2aed8a23595f906f48952a6f0487b5233258914c97953bc2d8002_0"},{"location":{"path":"server/services/job-catchup-service.ts","start":{"line":96,"col":23},"end":{"line":96,"col":71},"lines":"        console.error(`[JOB-CATCHUP] Error checking ${config.jobType}:`, checkError.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"72284444203e171443413aae6ee71a8bbce35e89a1b6dc258ada595f465792f672105823afd546f6f3476a454291e4edfca33b35733e99f793b230bc37b3c97b_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":81,"col":24},"end":{"line":81,"col":31},"lines":"    if (!fs.existsSync(dirPath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dirPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"e056db5068c9ef1ccd0d9f7d1b76149d35b5ed66c4f3a0f55bfd5ece8cf26e8e8bab5c9436de888717cc2640229d7e8e519f6d9c485feb70aa6b91b86e690efd_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":82,"col":20},"end":{"line":82,"col":27},"lines":"      fs.mkdirSync(dirPath, { recursive: true });"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dirPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"e056db5068c9ef1ccd0d9f7d1b76149d35b5ed66c4f3a0f55bfd5ece8cf26e8e8bab5c9436de888717cc2640229d7e8e519f6d9c485feb70aa6b91b86e690efd_1"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":122,"col":32},"end":{"line":122,"col":43},"lines":"    const filePath = path.join(documentDir, fileName);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"085a4c5818642275effc5302655285428f3c4c21bf445080e17b981f611db4eef1f17c4396e60cc955c3fc8d7b545ca46f1f02b6880e0c08832ab99eebae4cfa_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":122,"col":45},"end":{"line":122,"col":53},"lines":"    const filePath = path.join(documentDir, fileName);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"88d25eac3880e9cf1e74a44f239116c37417931300846926a639880d830c6e1411bb758c5824a8140cfb1cfebf6f62245cd644597d1d7b13462d8eec75c3b8aa_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":125,"col":22},"end":{"line":125,"col":30},"lines":"    fs.writeFileSync(filePath, buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `originalName` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"25b41906089ea6e4b286d4d48c9e2c96a5235b8e784d4e0e5864437f424e6b9df8ffcb2569a5375151f188ff88229c4c090a8f098b3666b82422959ad202e127_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":125,"col":22},"end":{"line":125,"col":30},"lines":"    fs.writeFileSync(filePath, buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `metadata` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"d74c1a18268a7ee706e3b8f495fecde109838f78a7dbdbdf148fc0983fce1a0c0c178ddc70c73fc78f1cb629b0da40f39fa18c4742a578099c637cce7409130d_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":156,"col":22},"end":{"line":156,"col":34},"lines":"    fs.writeFileSync(metadataPath, JSON.stringify(serializedFile, null, 2));"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `originalName` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"50bb0c32ace93caa1d1eb09ec5a39474c70c0e190738d887cc6dfb3b346707004ae68792533d6fe92367508a927da98329d58992142c790749412e135e70d752_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":156,"col":22},"end":{"line":156,"col":34},"lines":"    fs.writeFileSync(metadataPath, JSON.stringify(serializedFile, null, 2));"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `metadata` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"12e357fc5d4a452145d768319fdc7520af32f69738eca893a9147bebd67bc1b8fa2cc33eb3764784fde16eb3f9a2151c5c1e5ada5a65c7e7bea072f811b1903c_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":198,"col":28},"end":{"line":198,"col":66},"lines":"              console.warn(`Failed to read metadata file ${file}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"66414fe6ec25d9f240842862aeee7d35445dfd6c717bb8b7224e620b308b70e9b7333ea6137b94b4c3c1e1e40a1e57f3fb81f0dede78c7f52d07ddc47bccb4d0_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":203,"col":22},"end":{"line":203,"col":63},"lines":"        console.warn(`Failed to read directory ${documentDir}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9ae29cf5be3a45a2eca113516a616b34df95c0ac8b747da651cc12d67605d22bb542fdbb4438cc010a862029b0345a8ebf74d6c89985b3e8bc5aaadec2baf029_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":220,"col":38},"end":{"line":220,"col":55},"lines":"      const buffer = fs.readFileSync(metadata.filePath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"1dc6043313926cdd82ddf7e016a2720bbc8de55938454f5e2fe32bf6b236861f6ed107b3c37bc88a2170dae125b056cf937620e0c72b377af4fe29ded49e46bd_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":223,"col":21},"end":{"line":223,"col":67},"lines":"      console.error(`Failed to read file content for ID ${fileId}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"c1d7502cc2978dff6a28f2c3216cafada552261f37f779aa2e45b7e9a68ba62bfd5340dac6ae1c72a9528ed64238aac2ea4ee622b4672be93c85d015c211692b_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":245,"col":26},"end":{"line":245,"col":37},"lines":"      if (!fs.existsSync(documentDir)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filter` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"7fe9f1f26b9858ed3b2804870d3f2f528d165852f56451e4c1f2398eefbd3dddcfc99dca6d39ab06c04d78b3e4c60d63d26de96f5f334f489cfd4381e584dde9_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":250,"col":38},"end":{"line":250,"col":49},"lines":"        const files = fs.readdirSync(documentDir);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filter` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"7fe9f1f26b9858ed3b2804870d3f2f528d165852f56451e4c1f2398eefbd3dddcfc99dca6d39ab06c04d78b3e4c60d63d26de96f5f334f489cfd4381e584dde9_1"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":254,"col":44},"end":{"line":254,"col":55},"lines":"            const metadataPath = path.join(documentDir, file);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"87e07eaaa5683d998c0a273efd1986a7e06ed94b1eaa9e08ecc49a1dc7ae916b505780a66329fca8c75e8f1831e4007bc4f3a52af447c1cb18ad00f4ea14dcab_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":254,"col":57},"end":{"line":254,"col":61},"lines":"            const metadataPath = path.join(documentDir, file);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"1c96d77f4e931aadcdfef827484bf10e6c25b04724822571da79b6005aae902474a38aa4a721615b2fc7ced16d44863a873a7d9c1ddc48b9286182a59fffd69f_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":256,"col":47},"end":{"line":256,"col":59},"lines":"              const content = fs.readFileSync(metadataPath, 'utf-8');"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filter` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"19eb07c86a7410ac20a9df751a5c72f6a412a43699421be494d3319cc96bdb093037117e9a3932bc5f228a92da3b711c8a1425d219460b8c7434d380ccbc9ab9_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":287,"col":28},"end":{"line":287,"col":66},"lines":"              console.warn(`Failed to read metadata file ${file}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"66414fe6ec25d9f240842862aeee7d35445dfd6c717bb8b7224e620b308b70e9b7333ea6137b94b4c3c1e1e40a1e57f3fb81f0dede78c7f52d07ddc47bccb4d0_1"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":292,"col":22},"end":{"line":292,"col":63},"lines":"        console.warn(`Failed to read directory ${documentDir}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"9ae29cf5be3a45a2eca113516a616b34df95c0ac8b747da651cc12d67605d22bb542fdbb4438cc010a862029b0345a8ebf74d6c89985b3e8bc5aaadec2baf029_1"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":311,"col":25},"end":{"line":311,"col":42},"lines":"      if (fs.existsSync(metadata.filePath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"1dc6043313926cdd82ddf7e016a2720bbc8de55938454f5e2fe32bf6b236861f6ed107b3c37bc88a2170dae125b056cf937620e0c72b377af4fe29ded49e46bd_1"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":312,"col":23},"end":{"line":312,"col":40},"lines":"        fs.unlinkSync(metadata.filePath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"1dc6043313926cdd82ddf7e016a2720bbc8de55938454f5e2fe32bf6b236861f6ed107b3c37bc88a2170dae125b056cf937620e0c72b377af4fe29ded49e46bd_2"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":317,"col":25},"end":{"line":317,"col":37},"lines":"      if (fs.existsSync(metadataPath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"55f3338b922ba2251288fd796af6bb88200c7e04f4ad209056b31a87a48f45ef0bb1793781e0e23e87b26b75bcc1a1e3a407c3cd19148cbff461e5e3654f32ef_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":318,"col":23},"end":{"line":318,"col":35},"lines":"        fs.unlinkSync(metadataPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"55f3338b922ba2251288fd796af6bb88200c7e04f4ad209056b31a87a48f45ef0bb1793781e0e23e87b26b75bcc1a1e3a407c3cd19148cbff461e5e3654f32ef_1"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":323,"col":21},"end":{"line":323,"col":54},"lines":"      console.error(`Failed to delete file ${fileId}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"d150c0d1ba1f607d2c70076bb8f107c9184e71d7ba3b01542d0ce3e2e5bc9e341f0c32d17a4a3e164e507c80ee92272b30d68e71feb937e4facc1ba08e291437_0"},{"location":{"path":"server/services/local-file-storage.ts","start":{"line":356,"col":22},"end":{"line":356,"col":34},"lines":"    fs.writeFileSync(metadataPath, JSON.stringify(serializedFile, null, 2));"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"55f3338b922ba2251288fd796af6bb88200c7e04f4ad209056b31a87a48f45ef0bb1793781e0e23e87b26b75bcc1a1e3a407c3cd19148cbff461e5e3654f32ef_2"},{"location":{"path":"server/services/planner-sync-scheduler.ts","start":{"line":360,"col":23},"end":{"line":360,"col":86},"lines":"        console.error(`[PLANNER-SYNC] Failed to sync project ${connection.projectId}:`, projErr);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"4aa75dc59a18b4f41202861b29d9f609463ea0bb9ff17282125927063459f7d0ddc2e0543fe3869a431f29c08be32ef27da1e6989558c9e72201450b659bd8cc_0"},{"location":{"path":"server/services/planner-sync-scheduler.ts","start":{"line":474,"col":27},"end":{"line":474,"col":86},"lines":"            console.error(`[SUPPORT-PLANNER-SYNC] Error checking task ${sync.taskId}:`, taskErr.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"7ebbbee092ecd07c01dce5be72aeacc59363713bee67899ef6bc59ae6c41ae244bca7b1a2d170982a7d1a5e91123d85cc4fdd9b38781054b9d129608a5d70b2e_0"},{"location":{"path":"server/services/planner-sync-scheduler.ts","start":{"line":479,"col":23},"end":{"line":479,"col":83},"lines":"        console.error(`[SUPPORT-PLANNER-SYNC] Error syncing tenant ${tenant.name}:`, tenantErr.message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"d4fe1f2d7784b9e71ad5d5e4d2f0e52be8cf9af70f410349b1abce1fd741ec94a27ac38d6d94764841a345e0dbf7918d9dca5e0221a458dce2b37ef20371c3fc_0"},{"location":{"path":"server/services/receipt-normalizer.ts","start":{"line":94,"col":17},"end":{"line":94,"col":73},"lines":"    console.log(`[ReceiptNormalizer] Image metadata for ${originalName}:`, {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"43e242ae5d746fb0da7579b8b4f993329838b0e968a84f665c501c6065d4a11d0a9da3aba2e14a27e86de5a49ff53e1c851231ebd4df515ba11622d8fd90fff4_0"},{"location":{"path":"server/services/receipt-normalizer.ts","start":{"line":139,"col":19},"end":{"line":139,"col":79},"lines":"    console.error(`[ReceiptNormalizer] Error processing image ${originalName}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"54acf8a4b3cec7fe98473c320557d7cc5f3096329719da0e278da068fde7160a2db39602aee346db57028a9c0bc990b222c577176e2b431fdd44c33009c5a4eb_0"},{"location":{"path":"server/services/receipt-normalizer.ts","start":{"line":260,"col":11},"end":{"line":260,"col":93},"lines":"          `<tspan x=\"${padding}\" dy=\"${index === 0 ? 0 : lineHeight}\">${line || ' '}</tspan>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"101ef8b06c459952f943cb1ba17551cb16a826a71f716c11924a73149faf64e4a0f3884963cdc38bb00b0437e3d37efb4e5b4632fff5ee70799a8990ec91afd2_0"},{"location":{"path":"server/services/receipt-normalizer.ts","start":{"line":357,"col":21},"end":{"line":357,"col":94},"lines":"      console.error(`[ReceiptNormalizer] Failed to normalize ${receipts[index].originalName}:`, result.reason);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"3dca596d0be7af483b792bf55066d9b09797461d34b8711cd4181a899896410138656ccc71f066145f911a959405fb5bf1ce46f41442353dd86564f9240a4945_0"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":224,"col":43},"end":{"line":224,"col":51},"lines":"    const filePath = path.join(uploadDir, filename);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"b3d8f26c070dae6d0b4a0b1e6d61dae5f61d05d7358a520789ca2f53a1a5da078c9919a6b1b2708c85af996a710a883835522c6065912fff2cfbde24b80db6cf_0"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":225,"col":24},"end":{"line":225,"col":32},"lines":"    await fs.writeFile(filePath, buffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `filename` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"27761b7bc0fe406f08f0a5f8a040df133e7469831e7fad554166cf2fa356356568b0274f963abee06e285db4b9923c1fa67ae89016591b55313c9f8e911c97ec_0"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":230,"col":34},"end":{"line":230,"col":42},"lines":"    return path.join('receipts', filename);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"b3d8f26c070dae6d0b4a0b1e6d61dae5f61d05d7358a520789ca2f53a1a5da078c9919a6b1b2708c85af996a710a883835522c6065912fff2cfbde24b80db6cf_1"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":234,"col":58},"end":{"line":234,"col":64},"lines":"    const filePath = path.join(process.cwd(), 'uploads', fileId);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"03e52b62cceb671dd6b21d23988d2d01f9b85e7585a52ece717d28a3d276b5e70ee8b6e5bd614386450d921727d8aa27ea4146d78e2c7c734a6d065a5d4a0306_0"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":235,"col":30},"end":{"line":235,"col":38},"lines":"    return await fs.readFile(filePath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"cb31f1e7f40a19cf22a2166725981008aed22b75d0cac4d0f63c907e3c5e85e1e34b0e0e0601224a05016a9191856e1aa376dd3a59254bd7f0798937723df8c2_0"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":239,"col":58},"end":{"line":239,"col":64},"lines":"    const filePath = path.join(process.cwd(), 'uploads', fileId);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"03e52b62cceb671dd6b21d23988d2d01f9b85e7585a52ece717d28a3d276b5e70ee8b6e5bd614386450d921727d8aa27ea4146d78e2c7c734a6d065a5d4a0306_1"},{"location":{"path":"server/services/receipt-storage.ts","start":{"line":240,"col":21},"end":{"line":240,"col":29},"lines":"    await fs.unlink(filePath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"cb31f1e7f40a19cf22a2166725981008aed22b75d0cac4d0f63c907e3c5e85e1e34b0e0e0601224a05016a9191856e1aa376dd3a59254bd7f0798937723df8c2_1"},{"location":{"path":"server/services/sharepoint-file-storage.ts","start":{"line":443,"col":23},"end":{"line":443,"col":87},"lines":"          console.log(`[SharePointStorage] listAllFiles - Sample file from /${folder}:`, {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"d4b8c3618e53a82efca2c01d8e86c7e9609b442beb7d7fcf5413266634173d59f843965ac216d92d0fc489d4f6af469553064579a48eb01f61677e60970f5d9c_0"},{"location":{"path":"server/services/sharepoint-file-storage.ts","start":{"line":453,"col":21},"end":{"line":453,"col":67},"lines":"        console.log(`[SharePointStorage] Could not list ${folder}:`, error instanceof Error ? error.message : error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"eceec19e964872862ec5f12c7680b950fdf8f132d096ce4a3a0205d347c4381f3cc7afdc9d9e9eca1bdae3bd53a1a44905550c37ec3356cd8c1d5f51a85b7656_0"},{"location":{"path":"server/services/sharepoint-storage.ts","start":{"line":132,"col":21},"end":{"line":132,"col":73},"lines":"      console.error(`Error resolving drive ID for ${config.libraryName}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"abcf81d7ec56271913d3e42b4a16df02ba7b6c0ece003ef2a4adb5a1eb42e0b05f2980229bd5218a2258bf4b18f1bc4377422c516035cfed35fcabdedfd73eed_0"},{"location":{"path":"server/services/sharepoint-storage.ts","start":{"line":164,"col":21},"end":{"line":164,"col":58},"lines":"      console.error(`Error ensuring folder ${folderName}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"25b32967ef61bce0c9cb17c6f1d3aaeeb3d2c7527c47dd5ebd98764ace1f1398401f9b4dc44f3df7258da114faab63a1732f2ae18fcf916819111c14c3c095de_0"},{"location":{"path":"server/services/time-reminder-scheduler.ts","start":{"line":115,"col":58},"end":{"line":115,"col":87},"lines":"  const projectList = recipient.projectNames.map(name => `<li>${escapeHtml(name)}</li>`).join('');"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"7846f0025bff3030ad34a3f8affaab3a099d7e70401b8598993e8f4d3148df392b912f32db8bacfaa01eecaa00a048dcd7ec9ed6ce88a010dd7cc550136d1861_0"},{"location":{"path":"server/services/time-reminder-scheduler.ts","start":{"line":199,"col":23},"end":{"line":199,"col":87},"lines":"        console.error(`[TIME-REMINDERS] Failed to send reminder to ${recipient.email}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"961468e7ce55489efbb477c7256af1beb8aab7dadb3441e3dd4aa1a4012a8521e6ba1fade8853deb21e5898361bef6416e932d8fb9be1b23095bcd8db4b9cfd6_0"},{"location":{"path":"server/sub-sow-template.html","start":{"line":361,"col":9},"end":{"line":361,"col":24},"lines":"        {{{narrative}}}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.express.security.audit.xss.mustache.template-explicit-unescape","message":"Detected an explicit unescape in a Mustache template, using triple braces '{{{...}}}' or ampersand '&'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.","severity":"MEDIUM","fingerprint":"bc50c04260c011a62e3cfcb9971d6211b82053db3cfe179f761a65fdf53dce4ae9f18ba7d0244ca76243c7fafebfd94380f552369912fb7f64697395c3554ea0_0"},{"location":{"path":"uploads/contracts/M365CC25_-_Upgrade_Your_Company_Operating_System_with_Microsoft_Viva_e24d51bb.pdf.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"de11ff24-d798-42cc-ab90-8292ec16dff8\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"104290ab6aa4fd7e2370c27aa7554a134deb45320d6b5ed4a3b326f1bb4efb971ea1b517c5f99428eb3481e57874171a221387ac8afc03e409b57d23a0e81931_0"},{"location":{"path":"uploads/invoices/invoice-INV-2025-10-6071_8e3bbce7.pdf.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"63327da9-1de6-4d7e-807e-1ba36418af6f\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"b0d98ca101c88012a46fe23031bfbf13a669d5e36082a10e5037bc034df199c1a71d2b16a4718ed5af22be6551f9c5a8ab4bafa13ce4a00a02fda2150eee30c4_0"},{"location":{"path":"uploads/invoices/invoice-INV-2025-10-8087_d50ccd4a.pdf.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"6f332fa1-34e7-4029-9570-5c01b8c4ab00\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"86e16a677ca016f05fdd4bd447cf3e0bdd0de1a23e9f00cbb4af836d035aa6578c1f3efc5bed8e416ca14dffb2cc7c95cd1e9af628c5fd3837c4d7e62451ec6a_0"},{"location":{"path":"uploads/receipts/CP6_a818cd9a.jpeg.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"63327da9-1de6-4d7e-807e-1ba36418af6f\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"945c8c4341d78fcb8e5a957759efdc1fa43e9a0dbc0cf5bfb2c2f4c3436dc246b6d610a4a3dbbc082acd46a9c7984d75e2490fd72053bd8e32b5db688f6a6441_0"},{"location":{"path":"uploads/receipts/CP6_d3173d97.jpeg.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"207736014b83b02eb6953342bc18100f5b9e7c0bcf7758f2787eaf1f4bd234eb6bddceb2c89fe51292cc270f0fdbdef54561ac2afa9f77aca46328dbfb50d060_0"},{"location":{"path":"uploads/receipts/ExpertsLive_USA_2025_-_AI_ROI_58067871.pdf.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"de11ff24-d798-42cc-ab90-8292ec16dff8\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"957c4f47d856d625128f93528e98b3dfe3690ffca0c9b1030b8b56be38816de8fe5d50bb1c0c128fddfa3ac63613d8f4e8718f98d5740a2fd2fc06f9e8acaaed_0"},{"location":{"path":"uploads/receipts/FileTest-Ipy0NT_a259ff97.txt.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"75ac35690d21f2dc13ef3d59bae73c33e5c258bd283df3858a565a61b5851dc2e853614467c01c126266ef3793043a2c8124e98e17e82525f82db03e2789b17c_0"},{"location":{"path":"uploads/receipts/Project-Portfolio-Management-Report-2025-10-15-mgsngpkn040o8_604ebbc7.pdf.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"6a7f63efb8c0b935e39fe2a1130af36246aef992b7a01357102f35d25c7b106eda2819229500298af6280830305aa995c565ff3dd3ae286f9ff4344a0bd7732e_0"},{"location":{"path":"uploads/receipts/Test-BV1ylC_1b3e6bd3.txt.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"11fd96b06b377c683d0a482f411b3bc7782d946edc9d4bbd191fcbd81ba7f91ef8a716b0ee69ba12ce941dd82d259d9dfd83ee17d6bc22937b64db9a6f367bd2_0"},{"location":{"path":"uploads/receipts/test-EJZbaA_04fd441a.txt.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"677cb85fdba59c8e53a63661730a2e04a058743b278fd431dac3a066debf6a027fea89e211c786d59202917f03cc72fc4bc52836a7d074236752b1c9de7f7606_0"},{"location":{"path":"uploads/receipts/test-QLdLrt_52001575.txt.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"8a664b7305d8f3e8978c59e58d40eae73d367bbc514efd448d7a1a96da81ed8c948a4f2f5be1c479b859668e32bcef3da83b357965d38ae71cf83d6e67702eda_0"},{"location":{"path":"uploads/receipts/test-wJzfBY_306b9347.txt.metadata.json","start":{"line":10,"col":18},"end":{"line":10,"col":54},"lines":"    \"clientId\": \"db73b791-8ad9-4854-bbb3-f5379551b354\","},"checkId":".config.replit..semgrep.vendored-rules.generic.secrets.gitleaks.generic-api-key","message":"A gitleaks Generic API Key detected. Avoid hardcoding credentials directly in connection strings as this creates security risks. Instead, use environment variables to store and access credentials at runtime. If you need the actual credential values to make this work properly, ask me to provide them through Replit's secret system.","severity":"HIGH","fingerprint":"fc6e600fbbabedb3bf569bfad9997a591711697dad2b216d833991bc3c69a0a26570a31a2d220ca36a8ca53ecd345e1791294c7f8d02b95fd2c82f4c51494434_0"}]}